Search.setIndex({"docnames": ["index", "modules", "notebooks/DLFPC", "notebooks/Human_Lymph_Node", "notebooks/MERFISH", "notebooks/scRNA-seq", "step", "step.functionality", "step.functionality.base", "step.functionality.comps", "step.functionality.comps.model_ops", "step.functionality.comps.trainer", "step.functionality.cross_funcmodel", "step.functionality.sc_funcmodel", "step.functionality.st_funcmodel", "step.integration", "step.manager", "step.manager.save", "step.models", "step.models.clust", "step.models.deconv", "step.models.distributions", "step.models.extension", "step.models.geneformer", "step.models.knn_map", "step.models.nnls", "step.modules", "step.modules.decoder", "step.modules.gnn", "step.modules.transformer", "step.scmodel", "step.stmodel", "step.utils", "step.utils.dataset", "step.utils.gbolt", "step.utils.metrics", "step.utils.misc", "step.utils.plotting", "step.utils.synthetics", "step.utils.synthetics.pseudo_st"], "filenames": ["index.rst", "modules.rst", "notebooks/DLFPC.ipynb", "notebooks/Human_Lymph_Node.ipynb", "notebooks/MERFISH.ipynb", "notebooks/scRNA-seq.ipynb", "step.rst", "step.functionality.rst", "step.functionality.base.rst", "step.functionality.comps.rst", "step.functionality.comps.model_ops.rst", "step.functionality.comps.trainer.rst", "step.functionality.cross_funcmodel.rst", "step.functionality.sc_funcmodel.rst", "step.functionality.st_funcmodel.rst", "step.integration.rst", "step.manager.rst", "step.manager.save.rst", "step.models.rst", "step.models.clust.rst", "step.models.deconv.rst", "step.models.distributions.rst", "step.models.extension.rst", "step.models.geneformer.rst", "step.models.knn_map.rst", "step.models.nnls.rst", "step.modules.rst", "step.modules.decoder.rst", "step.modules.gnn.rst", "step.modules.transformer.rst", "step.scmodel.rst", "step.stmodel.rst", "step.utils.rst", "step.utils.dataset.rst", "step.utils.gbolt.rst", "step.utils.metrics.rst", "step.utils.misc.rst", "step.utils.plotting.rst", "step.utils.synthetics.rst", "step.utils.synthetics.pseudo_st.rst"], "titles": ["Welcome to STEP\u2019s documentation!", "step", "Spatial domain identification on 10x Visium DLFPC data", "Performing integrative analysis on scRNA-seq data and 10x Visium data of Human Lymph Node with STEP", "Reveal multiple level of biological heterogeneities in Mouse Hypothalamus by MERFISH-seq", "Integrate Human Immune Cell datasets with STEP and generate batch-corrected embeddings and gene expressions.", "step", "functionality", "base", "comps", "model ops", "trainer", "cross-modality", "scRNA-seq", "spatial transcriptomics", "&lt;no title&gt;", "manager", "&lt;no title&gt;", "models", "clustering", "deconvolution", "distributions", "extension", "geneformer", "knn sc map", "non-negative least squares deconvolution", "modules", "decoder", "gnn", "transformer", "&lt;no title&gt;", "&lt;no title&gt;", "utils", "dataset", "graph sampler", "metrics", "misc", "plotting", "synthetics", "&lt;no title&gt;"], "terms": {"an": [0, 4, 5], "acronym": 0, "spatial": [0, 1, 6, 7, 12], "transcriptom": [0, 1, 6, 7, 12], "embed": 0, "procedur": 0, "i": [0, 2, 3, 4, 5], "deep": [0, 4], "learn": [0, 3], "base": [0, 1, 3, 4, 6, 7], "tool": 0, "analysi": [0, 12], "singl": [0, 4, 13], "cell": [0, 13], "rna": [0, 13], "scrna": [0, 1, 6, 7, 12], "seq": [0, 1, 6, 7, 12], "resolv": 0, "srt": 0, "data": [0, 5, 12, 13], "introduc": 0, "unifi": 0, "approach": 0, "process": [0, 3, 4], "analyz": [0, 4], "multipl": [0, 2, 3], "sampl": [0, 3, 4], "well": 0, "align": 0, "sever": [0, 3], "section": [0, 4], "disregard": 0, "locat": [0, 3], "relationship": [0, 4], "furthermor": 0, "conduct": [0, 3], "integr": [0, 12], "across": [0, 4], "differ": [0, 3, 4], "modal": [0, 1, 6, 7], "like": 0, "function": [0, 1, 6, 12, 13, 14], "manag": [0, 1, 3, 6], "model": [0, 1, 2, 3, 6, 7, 9], "modul": [0, 1, 3, 4, 6, 12, 13, 14], "util": [0, 1, 2, 3, 4, 6], "comp": [0, 1, 6, 7], "cross": [0, 1, 6, 7], "cluster": [0, 1, 2, 3, 6, 18], "deconvolut": [0, 1, 6, 18], "distribut": [0, 1, 3, 6, 18], "extens": [0, 1, 6, 18], "geneform": [0, 1, 6, 18], "knn": [0, 1, 6, 18], "sc": [0, 1, 2, 3, 4, 5, 6, 18], "map": [0, 1, 6, 18], "non": [0, 1, 4, 6, 18], "neg": [0, 1, 3, 6, 18], "least": [0, 1, 6, 18], "squar": [0, 1, 6, 18], "decod": [0, 1, 3, 6, 26], "gnn": [0, 1, 6, 26], "transform": [0, 1, 3, 6, 26], "synthet": [0, 1, 6, 32], "dataset": [0, 1, 2, 3, 4, 6, 32], "graph": [0, 1, 2, 3, 4, 6, 32], "sampler": [0, 1, 6, 32], "metric": [0, 1, 2, 6, 32], "misc": [0, 1, 2, 6, 32], "plot": [0, 1, 3, 6, 32], "index": [0, 3], "search": 0, "page": 0, "op": [1, 6, 7, 9], "trainer": [1, 6, 7, 9], "1": [2, 3, 4, 5], "import": [2, 3, 4, 5], "o": [2, 3, 4], "torch": [2, 3], "scanpi": [2, 3, 4, 5], "seaborn": [2, 3, 4, 5], "sn": [2, 3, 4, 5], "matplotlib": [2, 3, 4, 5], "pyplot": [2, 3, 4, 5], "plt": [2, 3, 4, 5], "numpi": [2, 3, 4, 5], "np": [2, 3, 4, 5], "panda": [2, 3, 4, 5], "pd": [2, 3, 4, 5], "from": [2, 3, 4, 5], "step": 2, "stmodel": [2, 4], "set_se": 2, "sklearn": [2, 4], "adjusted_rand_scor": [2, 4], "anndata": [2, 3, 4], "ad": [2, 3, 4], "set": [2, 3, 5], "figdir": [2, 4, 5], "result": [2, 4], "dlpfc": 2, "set_figure_param": [2, 4, 5], "dpi_sav": [2, 4, 5], "300": [2, 4, 5], "figsiz": [2, 4], "6": [2, 3, 4, 5], "4": [2, 3, 4, 5], "5": [2, 3, 4, 5], "project": [2, 4], "82505004": [2, 4], "e7a0": [2, 4], "445f": [2, 4], "ab3c": [2, 4], "80d03c91438f": [2, 4], "cach": [2, 4], "pypoetri": [2, 4], "virtualenv": [2, 4], "ajq_bw_i": [2, 4], "py3": [2, 4], "10": [2, 3, 4, 5], "lib": [2, 4], "python3": [2, 4], "site": [2, 4], "packag": [2, 4], "tqdm": [2, 4], "auto": [2, 4], "py": [2, 4], "21": [2, 3, 4], "tqdmwarn": [2, 4], "iprogress": [2, 4], "found": [2, 4, 5], "pleas": [2, 4], "updat": [2, 4], "jupyt": [2, 4], "ipywidget": [2, 4], "see": [2, 3, 4], "http": [2, 3, 4], "readthedoc": [2, 4], "io": [2, 4], "en": [2, 4], "stabl": [2, 4], "user_instal": [2, 4], "html": [2, 4], "autonotebook": [2, 4], "notebook_tqdm": [2, 4], "2": [2, 3, 4, 5], "chdir": 2, "path": [2, 3], "expandus": 2, "case": 2, "studi": 2, "3": [2, 3, 4, 5], "42": 2, "stepc": [2, 4, 5], "file_path": [2, 4, 5], "151673_annot": 2, "h5ad": [2, 3, 4, 5], "n_top_gen": [2, 3, 4], "2000": [2, 3, 4, 5], "layer_kei": [2, 3, 4, 5], "none": [2, 3, 4], "module_dim": [2, 3, 4, 5], "30": [2, 3, 4, 5], "hidden_dim": [2, 3, 4, 5], "64": [2, 3, 4, 5], "n_modul": [2, 3, 4, 5], "decoder_typ": [2, 3, 4, 5], "zinb": [2, 3, 4], "fals": [2, 3, 4, 5], "n_glayer": [2, 3, 4], "try": [2, 5], "seurat_v3": [2, 5], "hvg": [2, 3, 5], "log_transform": [2, 3, 4, 5], "count": [2, 3, 4, 5], "layer": [2, 3, 4, 5], "39": [2, 3, 4, 5], "done": [2, 3, 4], "info": [2, 3, 4, 5], "batch": [2, 3, 4], "kei": [2, 3, 4, 5], "class": [2, 3, 4, 5], "number": [2, 3, 4, 5], "gene": [2, 4], "expr": [2, 3, 4, 5], "3639": 2, "Not": 2, "vae": 2, "run": [2, 3, 5], "n_iter": [2, 4], "3000": 2, "train": [2, 3, 4, 5], "e2": 2, "pattern": [2, 4], "100": [2, 3, 4, 5], "01": [2, 3, 4], "19": [2, 3, 4, 5], "lt": [2, 3, 4, 5], "00": [2, 3, 4, 5], "37": [2, 4], "96step": 2, "": [2, 3, 4, 5], "recon_loss": [2, 3, 4, 5], "1622": 2, "729": 2, "contrast_loss": [2, 3, 4], "0": [2, 3, 4, 5], "130": 2, "graph_id": 2, "adata": [2, 3, 4, 5], "object": [2, 3], "n_ob": [2, 3], "n_var": [2, 3], "ob": [2, 3, 4], "in_tissu": [2, 3, 4], "array_row": [2, 3], "array_col": [2, 3], "gd": 2, "n_gene": [2, 3, 4], "var": [2, 3], "gene_id": [2, 3], "feature_typ": [2, 3], "genom": [2, 3], "mt_gene": [2, 3], "highly_vari": 2, "highly_variable_rank": 2, "mean": [2, 3], "varianc": 2, "variances_norm": 2, "un": [2, 3], "log1p": 2, "obsm": [2, 3, 5], "mt": [2, 3], "x_smooth": [2, 3, 4], "7": [2, 3, 4, 5], "use_rep": [2, 3, 4, 5], "n_cluster": [2, 3, 4], "key_ad": [2, 3, 5], "cluster_": 2, "8": [2, 3, 4], "pp": [2, 3, 4, 5], "neighbor": [2, 3, 4, 5], "n_neighbor": 2, "tl": [2, 3, 4, 5], "umap": [2, 3, 4, 5], "9": [2, 3, 4], "pl": [2, 3, 4, 5], "color": [2, 3, 4, 5], "11": [2, 3, 4], "cat": [2, 3, 4], "code": [2, 3, 4], "6415591888519586": 2, "123456": 2, "16": [2, 3, 4, 5], "n_sampl": 2, "2400": 2, "3400": 2, "03": [2, 4], "18": [2, 3, 4], "71step": 2, "2270": 2, "652": 2, "kl_loss": [2, 3, 4, 5], "142": 2, "006": 2, "6854871224605329": 2, "save": [2, 3, 5], "config": 2, "f": [2, 3, 4, 5], "_annot": 2, "rang": 2, "151677": 2, "read_h5ad": [2, 4, 5], "enumer": 2, "concat": 2, "uns_merg": 2, "uniqu": [2, 4], "label": [2, 3, 4, 5], "dict_kei": 2, "151674": 2, "151675": 2, "value_count": [2, 3], "3673": 2, "3592": 2, "3460": 2, "name": [2, 3, 4], "dtype": [2, 3], "int64": [2, 3], "batch_kei": [2, 3, 4, 5], "true": [2, 3, 4, 5], "dec_norm": [2, 3], "dispers": [2, 3, 4], "14364": 2, "note": [2, 3, 4], "The": [2, 3, 4], "paper": [2, 3], "were": 2, "obtain": 2, "beta": [2, 4], "1e": [2, 3, 4], "graph_batch_s": [2, 4], "construct": 2, "04": [2, 3, 4], "05": [2, 3, 4], "14step": 2, "1045": 2, "916": 2, "002": 2, "579": 2, "_adata": [2, 4], "str": [2, 3], "append": 2, "print": [2, 4, 5], "6859044700752418": 2, "6737134878196837": 2, "6574160363368401": 2, "645033638093529": 2, "60": [2, 4], "col": 2, "ari_kmean": 2, "library_id": 2, "img_kei": 2, "titl": [2, 3, 4], "_ari_": 2, "2f": 2, "reuslt": 2, "p3": 2, "693643745029269": 2, "6823133597364682": 2, "6644988100827957": 2, "6493974579858672": 2, "thi": [3, 4, 5, 12, 13, 14], "tutori": [3, 4], "showcas": 3, "workflow": 3, "where": 3, "thei": 3, "ar": 3, "firstli": 3, "share": 3, "latent": 3, "space": 3, "subdomain": 3, "identifi": [3, 4], "subsequ": [3, 4], "spot": 3, "accord": 3, "crossmodel": 3, "plot_posterior_mu_vs_data": 3, "sc_file": 3, "human_lymph_integr": 3, "sc_pth": 3, "pth": 3, "st_pth": 3, "human_lymph_st_decod": 3, "st_file": [3, 4], "human_lymph_filt": 3, "exist": 3, "makedir": 3, "part": 3, "refer": 3, "cell2loc": 3, "adata_ref": 3, "read": 3, "lymph_sc": 3, "backup_url": 3, "cog": 3, "sanger": 3, "ac": 3, "uk": 3, "integrated_lymphoid_organ_scrna": 3, "regressionnbv4torch_57covariates_73260cells_10237gen": 3, "adata_vi": 3, "visium_sg": 3, "sample_id": 3, "v1_human_lymph_nod": 3, "var_names_make_uniqu": 3, "symbol": 3, "var_nam": [3, 4], "set_index": 3, "drop": 3, "inplac": 3, "renam": 3, "geneid": 3, "necessari": 3, "your": 3, "delet": 3, "unnecessari": 3, "raw": 3, "slot": 3, "remov": 3, "futur": 3, "version": 3, "del": 3, "requir": 3, "follow": 3, "paramet": [3, 4], "sc_adata": 3, "st_adata": 3, "geneset": [3, 4], "us": [3, 4], "specifi": 3, "column": 3, "class_kei": [3, 4, 5], "annoat": 3, "nb": [3, 5], "default": 3, "express": [3, 4], "other": 3, "about": 3, "dimens": 3, "final": 3, "hidden": 3, "n_moudl": 3, "normal": 3, "layernorm": 3, "batchnorm": 3, "ani": 3, "n_dec_hid_lay": [3, 4], "proc": 3, "subset": 3, "32": [3, 4, 5], "model_checkpoint": 3, "bcp005_total": 3, "13323": 3, "bcp006_total": 3, "4531": 3, "4861stdy7462253": 3, "4286": 3, "4861stdy7462255": 3, "4283": 3, "4035": 3, "4861stdy7528597": 3, "3888": 3, "bcp009_total": 3, "3867": 3, "4861stdy7462256": 3, "3852": 3, "4861stdy7528600": 3, "3594": 3, "4861stdy7528599": 3, "3172": 3, "4861stdy7135914": 3, "3126": 3, "4861stdy7462254": 3, "3085": 3, "4861stdy7528598": 3, "2961": [3, 4], "4861stdy7135913": 3, "2941": 3, "bcp008_total": 3, "2914": 3, "pan_t7935494": 3, "2876": 3, "bcp003_total": 3, "2083": 3, "bcp002_total": 3, "2002": 3, "human_colon_16s8000484": 3, "1308": 3, "4861stdy7208413": 3, "1228": 3, "4861stdy7208412": 3, "1130": 3, "human_colon_16s7255678": 3, "1125": 3, "bcp004_total": 3, "985": 3, "human_colon_16s7255677": 3, "700": 3, "In": [3, 4], "goal": 3, "extract": 3, "inform": 3, "transcript": 3, "also": 3, "elimin": [3, 4], "technic": 3, "effect": [3, 4], "meantim": 3, "so": 3, "differenti": 3, "ignor": [3, 4], "tune_epoch": [3, 4, 5], "200": 3, "need_anchor": 3, "beta1": [3, 4], "somewhat": 3, "special": 3, "onli": [3, 4], "when": 3, "refin": 3, "annot": 3, "valid": [3, 4, 5], "control": 3, "iter": 3, "coeffici": 3, "kl": 3, "diverg": 3, "adjust": 3, "can": [3, 4], "chang": 3, "degre": 3, "higher": 3, "valu": [3, 4], "lower": 3, "epoch": [3, 4, 5], "400": [3, 4, 5], "batch_siz": [3, 4, 5], "2048": [3, 4], "split_rat": [3, 4, 5], "categori": [3, 4, 5], "random": [3, 4, 5], "split": [3, 4, 5], "size": [3, 4, 5], "2352": 3, "2500": 3, "904": 3, "982": 3, "3428": 3, "2468": 3, "3426": 3, "3081": 3, "3110": 3, "2368": 3, "2537": 3, "2875": 3, "1601": 3, "1666": 3, "788": 3, "10658": 3, "3624": 3, "2331": 3, "3093": 3, "560": 3, "900": 3, "1046": 3, "2300": 3, "3228": 3, "61826": 3, "15469": 3, "86": [3, 4], "344": 3, "27": [3, 4, 5], "23": 3, "78": [3, 4], "198": 3, "1147": 3, "656": 3, "val_kl_loss": [3, 4, 5], "229": 3, "233": [3, 4], "val_recon_loss": [3, 4, 5], "362": 3, "1143": 3, "838": 3, "earli": [3, 4, 5], "stop": [3, 4, 5], "trigger": [3, 4, 5], "earlystop": [3, 4, 5], "counter": [3, 4, 5], "out": [3, 4, 5], "examin": 3, "qc": 3, "imput": 3, "x_rep": [3, 4, 5], "As": 3, "we": [3, 4], "mix": 3, "left": 3, "figur": [3, 5], "moreov": 3, "right": 3, "structur": 3, "total": 3, "preserv": 3, "indic": 3, "biolog": 3, "meaning": 3, "successfulli": 3, "12": [3, 4], "ncol": 3, "13": [3, 4], "_function": 3, "state_dict": 3, "e": 3, "identif": 3, "previou": 3, "produc": 3, "while": 3, "paramt": [3, 4], "add_emb": 3, "desir": 3, "smoother": 3, "gcn": 3, "smooth": 3, "sole": 3, "transcprit": 3, "stage": [3, 4], "involv": 3, "achiev": 3, "sub": 3, "option": 3, "trane": 3, "specif": 3, "concentr": 3, "still": 3, "doesn": 3, "t": [3, 5], "context": [3, 4], "n_dec_lay": 3, "use_st_decod": 3, "whether": 3, "fit": 3, "convolut": 3, "smooth_epoch": 3, "tune_lr": [3, 4], "rate": 3, "tune": 3, "st": 3, "14": [3, 4], "generate_domain": 3, "800": [3, 4], "1024": [3, 4, 5], "24": [3, 4, 5], "34": [3, 5], "rep": 3, "58": 3, "63epoch": 3, "4178": 3, "889": 3, "stdecod": 3, "start": 3, "47": 3, "79epoch": 3, "846": 3, "4188": 3, "098": 3, "val_contrast_loss": [3, 4], "defualt": 3, "store": 3, "here": 3, "kmean": 3, "further": 3, "15": [3, 4, 5], "sub_clust": 3, "pre_kei": 3, "sub_domain": 3, "origin": 3, "through": [3, 4], "same": 3, "previous": 3, "st_imput": 3, "17": [3, 4], "wise": 3, "sinc": 3, "similar": 3, "featur": [3, 4], "domain_kei": 3, "mainli": 3, "evalu": 3, "between": 3, "correspond": 3, "denot": 3, "anchor": 3, "measur": 3, "spars": 3, "attent": 3, "mechan": 3, "ensur": 3, "sparsiti": 3, "occur": 3, "To": 3, "consid": 3, "individu": 3, "encod": 3, "disabl": 3, "hard_anchor": 3, "And": 3, "bound": 3, "add": 3, "contrast": [3, 4], "loss": 3, "regular": 3, "temperatur": 3, "actual": 3, "scale": 3, "simlar": 3, "matrix": 3, "minim": 3, "log": 3, "likelihood": 3, "estim": 3, "signatur": 3, "averg": 3, "use_raw": 3, "For": [3, 4], "balanc": 3, "major": 3, "reconstruct": 3, "lossess": 3, "sub_domain_cod": 3, "deconv": 3, "domain_wis": 3, "36epoch": 3, "div": 3, "186": 3, "loss_ori": 3, "250": 3, "2080": 3, "224": 3, "sc_consist": 3, "709": 3, "val_div": 3, "val_loss_ori": 3, "val_sc_consist": 3, "celltyp": 3, "prop_list": 3, "to_list": 3, "20": [3, 4, 5], "batch_st": 3, "b_cycl": 3, "b_gc_dz": 3, "b_gc_lz": 3, "b_gc_prepb": 3, "b_ifn": 3, "b_activ": 3, "b_mem": 3, "b_naiv": 3, "b_plasma": 3, "b_pregc": 3, "dc_ccr7": 3, "dc_cdc1": 3, "dc_cdc2": 3, "dc_pdc": 3, "endo": 3, "fdc": 3, "ilc": 3, "macrophages_m1": 3, "macrophages_m2": 3, "mast": 3, "monocyt": [3, 5], "nk": [3, 5], "nkt": [3, 5], "t_cd4": 3, "_tfh": 3, "_tfh_gc": 3, "_naiv": 3, "t_cd8": 3, "_cd161": 3, "_cytotox": 3, "t_tim3": 3, "t_tfr": 3, "t_treg": 3, "vsmc": 3, "domain_color": 3, "sub_domain_color": 3, "x_rep_tsfmr": 3, "deconv_abund": 3, "st_expected_count": 3, "22": [3, 4], "astyp": [3, 4], "dendrogram": 3, "groupbi": 3, "rank_genes_group": 3, "method": 3, "wilcoxon": 3, "rank_genes_groups_matrixplot": 3, "group": 3, "values_to_plot": 3, "logfoldchang": 3, "cmap": [3, 4], "rdbu_r": 3, "vmin": 3, "vmax": 3, "warn": [3, 4, 5], "reorder": 3, "becaus": 3, "var_group_label": 3, "etc": 3, "mainplot_ax": 3, "axessubplot": 3, "gt": [3, 4, 5], "group_extra_ax": 3, "gene_group_ax": 3, "color_legend_ax": 3, "center": 3, "fold": 3, "25": [3, 4, 5], "gc": 3, "summarize_domain": 3, "showca": 4, "ha": 4, "been": 4, "design": 4, "shed": 4, "light": 4, "aspect": 4, "cellular": 4, "complex": 4, "captur": 4, "genet": 4, "facilit": 4, "understand": 4, "among": 4, "end": 4, "A": 4, "streamlin": 4, "directli": 4, "aim": 4, "guid": 4, "user": 4, "capabl": 4, "enabl": [4, 5], "dive": 4, "intricaci": 4, "scmodel": [4, 5], "merfish_animal1": 4, "hetorogen": 4, "resolut": 4, "which": 4, "focu": 4, "transcipt": 4, "potenti": 4, "present": [4, 5], "even": 4, "though": 4, "resovl": 4, "due": 4, "limit": 4, "techniqu": 4, "re": 4, "161": 4, "all": [4, 5], "fewer": 4, "bregma": 4, "cell_class": 4, "given": 4, "28316": 4, "head": 4, "animal_id": 4, "animal_sex": 4, "behavior": 4, "centroid_x": 4, "centroid_i": 4, "neuron_cluster_id": 4, "cell_id": 4, "6c59b1ec": 4, "95df": 4, "4f25": 4, "882a": 4, "ac94d99b87d8": 4, "femal": 4, "naiv": 4, "3033": 4, "401378": 4, "2825": 4, "155877": 4, "endotheli": 4, "nan": 4, "29": [4, 5], "aa7ce410": 4, "c485": 4, "42c9": 4, "9c29": 4, "bc1d90a46e00": 4, "3027": 4, "328655": 4, "2955": 4, "936449": 4, "inhibitori": 4, "61": 4, "8426329e": 4, "077b": 4, "4385": 4, "bd94": 4, "c9fdaeb89bd1": 4, "3020": 4, "512953": 4, "696710": 4, "54": 4, "a7e4e0d": 4, "8baa": 4, "4136": 4, "8cac": 4, "fa9bc759e7e8": 4, "3017": 4, "397490": 4, "2995": 4, "915801": 4, "c55468d5": 4, "1b2c": 4, "4477": 4, "b4ad": 4, "3653f5bbda35": 4, "3005": 4, "478613": 4, "2877": 4, "528929": 4, "40": 4, "beta2": 4, "perform": [4, 5], "4434": 4, "4641": 4, "4740": 4, "09": 4, "4445": 4, "4390": 4, "22650": 4, "5666": 4, "current": [4, 5], "multi_batch": [4, 5], "gene_expr": [4, 5], "batch_label": [4, 5], "27epoch": 4, "391": 4, "160": 4, "094": 4, "473": 4, "288": 4, "154": 4, "405": 4, "153": 4, "951": 4, "multi_batches_with_ct": [4, 5], "class_label": [4, 5], "astrocyt": 4, "2724": 4, "1184": 4, "115": 4, "439": 4, "ependym": 4, "1029": 4, "excitatori": 4, "4629": 4, "9895": 4, "microglia": 4, "475": 4, "od": 4, "immatur": 4, "809": [4, 5], "matur": 4, "190": 4, "922": 4, "pericyt": 4, "163": 4, "22647": 4, "5669": 4, "31": 4, "05epoch": 4, "cl_loss": [4, 5], "036": 4, "009": [4, 5], "val_cl_loss": [4, 5], "317": 4, "010": 4, "06": 4, "03epoch": 4, "x_anchord": [4, 5], "scib_metr": [4, 5], "benchmark": [4, 5], "bioconserv": [4, 5], "biocon": 4, "nmi_ari_cluster_labels_leiden": [4, 5], "nmi_ari_cluster_labels_kmean": 4, "batcon": 4, "batchcorrect": [4, 5], "pcr_comparison": 4, "bm": [4, 5], "label_kei": [4, 5], "embedding_obsm_kei": [4, 5], "x_pca_correct": 4, "x_pca": [4, 5], "bio_conservation_metr": [4, 5], "batch_correction_metr": 4, "n_job": [4, 5], "plot_results_t": [4, 5], "min_max_scal": [4, 5], "comput": [4, 5], "70": 4, "bio": 4, "conserv": 4, "isolated_label": 4, "jax": [4, 5], "_src": [4, 5], "xla_bridg": [4, 5], "nvidia": [4, 5], "gpu": [4, 5], "mai": [4, 5], "machin": [4, 5], "cuda": [4, 5], "jaxlib": [4, 5], "instal": [4, 5], "fall": [4, 5], "back": [4, 5], "cpu": [4, 5], "02": [4, 5], "46": 4, "silhouette_label": 4, "94": 4, "clisi_knn": 4, "69": 4, "correct": 4, "silhouette_batch": 4, "50": [4, 5], "93": 4, "ilisi_knn": 4, "67": 4, "kbet_per_label": 4, "35": 4, "graph_connect": 4, "80": 4, "36": 4, "atch": 4, "83": 4, "26": 4, "33": [4, 5], "plottabl": [4, 5], "tabl": [4, 5], "0x7fdb6c7edd20": 4, "model_config": 4, "dict": 4, "max_neighbor": 4, "variat": 4, "run_config": 4, "filter": 4, "coord_kei": 4, "edge_clip": 4, "use_earlystop": 4, "global": 4, "48": 4, "75epoch": 4, "880": 4, "146": 4, "231": 4, "884": 4, "147": 4, "476": 4, "07": [4, 5], "45": 4, "72epoch": 4, "012": 4, "212": 4, "722": 4, "x_unsmooth": 4, "spatial_plot": 4, "with_imag": 4, "provid": 4, "length": 4, "doe": 4, "match": 4, "first": 4, "instead": 4, "strategi": 4, "bass": 4, "listdir": 4, "merfish_anno": 4, "anno": 4, "read_csv": 4, "index_col": 4, "batch_id": 4, "loc": 4, "float": 4, "x": 4, "geneset_to_us": 4, "compon": 4, "input_dim": 4, "decoder_input_dim": 4, "60step": 4, "370": [4, 5], "799": 4, "428": 4, "011": 4, "scatter": 4, "y": 4, "c": 4, "int": 4, "tab20": 4, "show": [4, 5], "ari": 4, "5337230222364567": 4, "6226701393120998": 4, "49295132575539485": 4, "6502377274236062": 4, "6812873877486072": 4, "extern": 5, "sce": 5, "frameon": 5, "dpi": 5, "def": 5, "get_umap": 5, "embed_kei": 5, "return": 5, "els": 5, "_": 5, "_umap": 5, "png": 5, "scib_benchmark": 5, "immune_all_human": 5, "cell_state_kei": 5, "final_annot": 5, "pca": 5, "n_comp": 5, "check": 5, "33506": 5, "10x": 5, "8581": 5, "freytag": 5, "2677": 5, "oetjen_a": 5, "2068": 5, "oetjen_p": 5, "2612": 5, "oetjen_u": 5, "2984": 5, "sun_sample1_c": 5, "1380": 5, "sun_sample2_kc": 5, "1824": 5, "sun_sample3_tb": 5, "1922": 5, "sun_sample4_tc": 5, "1936": 5, "villani": 5, "817": 5, "26801": 5, "6705": 5, "mode": 5, "08": 5, "215": 5, "732": 5, "441": 5, "246": 5, "386": 5, "758": 5, "566": 5, "753": 5, "340": 5, "cd4": 5, "8808": 5, "cd8": 5, "1746": 5, "cd10": 5, "b": 5, "165": 5, "cd14": 5, "5186": 5, "cd16": 5, "797": 5, "cd20": 5, "2298": 5, "erythrocyt": 5, "1201": 5, "erythroid": 5, "progenitor": 5, "hspc": 5, "378": 5, "megakaryocyt": 5, "216": 5, "342": 5, "deriv": 5, "dendrit": 5, "1835": 5, "2196": 5, "plasma": 5, "103": 5, "plasmacytoid": 5, "348": 5, "26798": 5, "6708": 5, "56": 5, "020": 5, "782": 5, "462": 5, "57": 5, "x_pca_uncorrect": 5, "regress_out": 5, "batch_us": 5, "library_s": 5, "1e5": 5, "corrected_count": 5, "neighbors_kei": 5, "bioc": 5, "109": 5, "85": 5, "0x7fcaac525960": 5, "implement": [12, 13, 14]}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "step": [0, 1, 3, 4, 5, 6], "": 0, "document": 0, "tutori": 0, "api": 0, "indic": 0, "tabl": 0, "spatial": [2, 3, 4, 14], "domain": [2, 3, 4], "identif": [2, 4], "10x": [2, 3], "visium": [2, 3], "dlfpc": 2, "data": [2, 3, 4], "151673": 2, "singl": 2, "section": 2, "without": 2, "us": 2, "variat": 2, "151676": 2, "togeth": 2, "plot": [2, 37], "ari": 2, "na": 2, "spot": 2, "perform": 3, "integr": [3, 5], "analysi": 3, "scrna": [3, 13], "seq": [3, 4, 13], "human": [3, 5], "lymph": 3, "node": 3, "load": [3, 4], "packag": 3, "initi": 3, "instanc": 3, "co": 3, "embed": [3, 4, 5], "two": 3, "modal": [3, 12], "get": 3, "check": 3, "result": 3, "zonat": 3, "after": 3, "cell": [3, 4, 5], "type": 3, "deconvolut": [3, 20, 25], "obtain": [3, 4], "visual": [3, 4], "infer": 3, "composit": 3, "de": 3, "gene": [3, 5], "anlaysi": 3, "summar": 3, "averag": 3, "proport": 3, "select": 3, "each": 3, "reveal": 4, "multipl": 4, "level": 4, "biolog": 4, "heterogen": 4, "mous": 4, "hypothalamu": 4, "merfish": 4, "state": 4, "setup": 4, "object": 4, "smooth": 4, "e2": 4, "mode": 4, "direct": 4, "model": [4, 10, 18], "config": 4, "run": 4, "add": 4, "annot": 4, "zone": 4, "set": 4, "up": 4, "gener": [4, 5], "cluster": [4, 19], "them": 4, "metric": [4, 35], "evalu": 4, "compar": 4, "immun": 5, "dataset": [5, 33], "batch": 5, "correct": 5, "express": 5, "function": 7, "base": 8, "comp": 9, "op": 10, "trainer": 11, "cross": 12, "transcriptom": 14, "manag": 16, "distribut": 21, "extens": 22, "geneform": 23, "knn": 24, "sc": 24, "map": 24, "non": 25, "neg": 25, "least": 25, "squar": 25, "modul": 26, "decod": 27, "gnn": 28, "transform": 29, "util": 32, "graph": 34, "sampler": 34, "misc": 36, "synthet": 38}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Welcome to STEP\u2019s documentation!": [[0, "welcome-to-step-s-documentation"]], "Tutorials:": [[0, null]], "API:": [[0, null]], "Indices and tables": [[0, "indices-and-tables"]], "step": [[1, "step"], [6, "step"]], "Spatial domain identification on 10x Visium DLFPC data": [[2, "Spatial-domain-identification-on-10x-Visium-DLFPC-data"]], "151673 single section without using variational": [[2, "151673-single-section-without-using-variational"]], "151673 single section with using variational": [[2, "151673-single-section-with-using-variational"]], "151673 to 151676 together": [[2, "151673-to-151676-together"]], "Spatial plots and ARIs without NA spots": [[2, "Spatial-plots-and-ARIs-without-NA-spots"]], "Performing integrative analysis on scRNA-seq data and 10x Visium data of Human Lymph Node with STEP": [[3, "Performing-integrative-analysis-on-scRNA-seq-data-and-10x-Visium-data-of-Human-Lymph-Node-with-STEP"]], "Loading packages": [[3, "Loading-packages"]], "Load data": [[3, "Load-data"]], "Initialize the STEP instance": [[3, "Initialize-the-STEP-instance"]], "Co-embedding two modalities": [[3, "Co-embedding-two-modalities"]], "Get and check the co-embedding results": [[3, "Get-and-check-the-co-embedding-results"]], "Zonation after integration": [[3, "Zonation-after-integration"]], "Cell-type deconvolution with obtained embedding": [[3, "Cell-type-deconvolution-with-obtained-embedding"]], "Visualize the inferred cell-type composition": [[3, "Visualize-the-inferred-cell-type-composition"]], "Perform spatially DE genes anlaysis": [[3, "Perform-spatially-DE-genes-anlaysis"]], "Summarize the average proportion of selected cell-types in each domain": [[3, "Summarize-the-average-proportion-of-selected-cell-types-in-each-domain"]], "Reveal multiple level of biological heterogeneities in Mouse Hypothalamus by MERFISH-seq": [[4, "Reveal-multiple-level-of-biological-heterogeneities-in-Mouse-Hypothalamus-by-MERFISH-seq"]], "Cell state level heterogeneity": [[4, "Cell-state-level-heterogeneity"]], "Setup STEP object": [[4, "Setup-STEP-object"]], "Spatial domain level heterogeneity by spatially smoothing the embedding in cell state level": [[4, "Spatial-domain-level-heterogeneity-by-spatially-smoothing-the-embedding-in-cell-state-level"]], "E2E mode for direct spatial domain identification": [[4, "E2E-mode-for-direct-spatial-domain-identification"]], "Model config & running config": [[4, "Model-config-&-running-config"]], "Load data and add annotations of zones": [[4, "Load-data-and-add-annotations-of-zones"]], "Set up STEP object": [[4, "Set-up-STEP-object"]], "Generate spatially smoothed embeddings and cluster them to obtain spatial domains": [[4, "Generate-spatially-smoothed-embeddings-and-cluster-them-to-obtain-spatial-domains"]], "Visualization": [[4, "Visualization"]], "Metrics for evaluation of the obtained spatial domains compared to the annotations": [[4, "Metrics-for-evaluation-of-the-obtained-spatial-domains-compared-to-the-annotations"]], "Integrate Human Immune Cell datasets with STEP and generate batch-corrected embeddings and gene expressions.": [[5, "Integrate-Human-Immune-Cell-datasets-with-STEP-and-generate-batch-corrected-embeddings-and-gene-expressions."]], "functionality": [[7, "functionality"]], "base": [[8, "base"]], "comps": [[9, "comps"]], "model ops": [[10, "model-ops"]], "trainer": [[11, "trainer"]], "cross-modality": [[12, "cross-modality"]], "scRNA-seq": [[13, "scrna-seq"]], "spatial transcriptomics": [[14, "spatial-transcriptomics"]], "manager": [[16, "manager"]], "models": [[18, "models"]], "clustering": [[19, "clustering"]], "deconvolution": [[20, "deconvolution"]], "distributions": [[21, "distributions"]], "extension": [[22, "extension"]], "geneformer": [[23, "geneformer"]], "knn sc map": [[24, "knn-sc-map"]], "non-negative least squares deconvolution": [[25, "non-negative-least-squares-deconvolution"]], "modules": [[26, "modules"]], "decoder": [[27, "decoder"]], "gnn": [[28, "gnn"]], "transformer": [[29, "transformer"]], "utils": [[32, "utils"]], "dataset": [[33, "dataset"]], "graph sampler": [[34, "graph-sampler"]], "metrics": [[35, "metrics"]], "misc": [[36, "misc"]], "plotting": [[37, "plotting"]], "synthetics": [[38, "synthetics"]]}, "indexentries": {}})