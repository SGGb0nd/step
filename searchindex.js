Search.setIndex({"docnames": ["autoapi/index", "autoapi/step/functionality/base/index", "autoapi/step/functionality/comps/index", "autoapi/step/functionality/comps/model_ops/index", "autoapi/step/functionality/comps/trainer/index", "autoapi/step/functionality/cross_funcmodel/index", "autoapi/step/functionality/index", "autoapi/step/functionality/sc_funcmodel/index", "autoapi/step/functionality/st_funcmodel/index", "autoapi/step/index", "autoapi/step/integration/index", "autoapi/step/manager/index", "autoapi/step/manager/save/index", "autoapi/step/models/clust/index", "autoapi/step/models/deconv/index", "autoapi/step/models/distributions/index", "autoapi/step/models/extension/index", "autoapi/step/models/geneformer/index", "autoapi/step/models/index", "autoapi/step/models/knn_map/index", "autoapi/step/models/nnls/index", "autoapi/step/modules/decoder/index", "autoapi/step/modules/gnn/index", "autoapi/step/modules/index", "autoapi/step/modules/transformer/index", "autoapi/step/scmodel/index", "autoapi/step/stmodel/index", "autoapi/step/utils/dataset/index", "autoapi/step/utils/gbolt/index", "autoapi/step/utils/index", "autoapi/step/utils/metrics/index", "autoapi/step/utils/misc/index", "autoapi/step/utils/plotting/index", "autoapi/step/utils/synthetics/index", "autoapi/step/utils/synthetics/pseudo_st/index", "index", "notebooks/DLFPC", "notebooks/Human_Lymph_Node", "notebooks/MERFISH", "notebooks/scRNA-seq"], "filenames": ["autoapi/index.rst", "autoapi/step/functionality/base/index.rst", "autoapi/step/functionality/comps/index.rst", "autoapi/step/functionality/comps/model_ops/index.rst", "autoapi/step/functionality/comps/trainer/index.rst", "autoapi/step/functionality/cross_funcmodel/index.rst", "autoapi/step/functionality/index.rst", "autoapi/step/functionality/sc_funcmodel/index.rst", "autoapi/step/functionality/st_funcmodel/index.rst", "autoapi/step/index.rst", "autoapi/step/integration/index.rst", "autoapi/step/manager/index.rst", "autoapi/step/manager/save/index.rst", "autoapi/step/models/clust/index.rst", "autoapi/step/models/deconv/index.rst", "autoapi/step/models/distributions/index.rst", "autoapi/step/models/extension/index.rst", "autoapi/step/models/geneformer/index.rst", "autoapi/step/models/index.rst", "autoapi/step/models/knn_map/index.rst", "autoapi/step/models/nnls/index.rst", "autoapi/step/modules/decoder/index.rst", "autoapi/step/modules/gnn/index.rst", "autoapi/step/modules/index.rst", "autoapi/step/modules/transformer/index.rst", "autoapi/step/scmodel/index.rst", "autoapi/step/stmodel/index.rst", "autoapi/step/utils/dataset/index.rst", "autoapi/step/utils/gbolt/index.rst", "autoapi/step/utils/index.rst", "autoapi/step/utils/metrics/index.rst", "autoapi/step/utils/misc/index.rst", "autoapi/step/utils/plotting/index.rst", "autoapi/step/utils/synthetics/index.rst", "autoapi/step/utils/synthetics/pseudo_st/index.rst", "index.rst", "notebooks/DLFPC.ipynb", "notebooks/Human_Lymph_Node.ipynb", "notebooks/MERFISH.ipynb", "notebooks/scRNA-seq.ipynb"], "titles": ["Tutorials", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.base</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.comps</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.comps.model_ops</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.comps.trainer</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.cross_funcmodel</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.sc_funcmodel</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.functionality.st_funcmodel</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.integration</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.manager</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.manager.save</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.clust</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.deconv</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.distributions</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.extension</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.geneformer</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.knn_map</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.models.nnls</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.modules.decoder</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.modules.gnn</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.modules</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.modules.transformer</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.scmodel</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.stmodel</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.dataset</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.gbolt</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.metrics</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.misc</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.plotting</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.synthetics</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">step.utils.synthetics.pseudo_st</span></code>", "Welcome to STEP\u2019s documentation!", "Spatial domain identification on 10x Visium DLFPC data", "Performing integrative analysis on scRNA-seq data and 10x Visium data of Human Lymph Node with STEP", "Reveal multiple level of biological heterogeneities in Mouse Hypothalamus by MERFISH-seq", "Integrate Human Immune Cell datasets with STEP and generate batch-corrected embeddings and gene expressions."], "terms": {"thi": [0, 3, 7, 16, 21, 22, 24, 31, 37, 38, 39], "page": 0, "contain": [0, 1, 3, 4, 5, 7, 8, 10, 16, 21, 22, 24, 25, 26, 30, 31, 32], "how": [0, 11], "us": [0, 1, 3, 4, 5, 7, 8, 10, 11, 13, 14, 15, 16, 17, 19, 22, 26, 27, 31, 35, 37, 38], "step": [0, 36], "spatial": [0, 5, 8, 10, 14, 19, 26, 27, 30, 31, 32, 34, 35], "domain": [0, 5, 8, 10, 14, 26, 27, 32, 34, 35], "identif": [0, 35, 37], "10x": [0, 31, 35, 39], "visium": [0, 31, 35], "dlfpc": [0, 35], "data": [0, 1, 3, 4, 5, 7, 8, 10, 13, 15, 16, 19, 25, 26, 27, 30, 31, 32, 34, 35, 39], "perform": [0, 3, 5, 7, 8, 16, 20, 26, 35, 38, 39], "integr": [0, 5, 9, 27, 35], "analysi": [0, 25, 35], "scrna": [0, 3, 5, 7, 19, 35], "seq": [0, 3, 5, 7, 10, 19, 25, 35], "human": [0, 11, 27, 35], "lymph": [0, 35], "node": [0, 4, 8, 28, 35], "reveal": [0, 35], "multipl": [0, 4, 31, 32, 35, 36, 37], "level": [0, 11, 35], "biolog": [0, 35, 37], "heterogen": [0, 35], "mous": [0, 35], "hypothalamu": [0, 35], "merfish": [0, 35], "immun": [0, 35], "cell": [0, 3, 5, 7, 10, 14, 25, 26, 27, 31, 32, 34, 35], "dataset": [0, 1, 3, 4, 5, 7, 8, 9, 10, 12, 25, 26, 29, 31, 35, 36, 37, 38], "gener": [0, 3, 5, 7, 8, 13, 15, 31, 35], "batch": [0, 1, 3, 4, 5, 7, 8, 10, 16, 17, 21, 25, 27, 31, 32, 34, 35, 36, 37, 38], "correct": [0, 3, 35, 38], "embed": [0, 1, 4, 7, 8, 10, 14, 16, 26, 31, 35], "gene": [0, 1, 3, 7, 8, 10, 16, 17, 25, 26, 27, 31, 35, 36, 38], "express": [0, 1, 3, 7, 10, 15, 17, 25, 26, 31, 35, 37, 38], "auto": [0, 36, 38], "document": 0, "f1": 0, "_": [0, 15, 39], "function": [0, 9, 12, 14, 16, 17, 21, 22, 25, 27, 35], "comp": [0, 1, 6, 9], "model_op": [0, 1, 2, 6, 9], "trainer": [0, 1, 2, 6, 9], "base": [0, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 21, 22, 24, 26, 27, 28, 31, 35, 37, 38], "cross_funcmodel": [0, 6, 9], "sc_funcmodel": [0, 5, 6, 9, 25], "st_funcmodel": [0, 6, 9], "manag": [0, 9, 35, 37], "save": [0, 9, 10, 11, 25, 26, 34, 36, 37, 39], "model": [0, 1, 3, 4, 5, 7, 8, 9, 10, 12, 21, 22, 24, 25, 26, 35, 36, 37], "clust": [0, 9, 18], "deconv": [0, 5, 9, 10, 18, 26, 32, 37], "distribut": [0, 3, 9, 14, 17, 18, 21, 30, 37], "extens": [0, 7, 9, 18], "geneform": [0, 1, 3, 4, 7, 9, 16, 18], "knn_map": [0, 9, 18], "nnl": [0, 5, 9, 18], "modul": [0, 9, 11, 35, 37, 38], "decod": [0, 3, 5, 7, 9, 16, 17, 23, 37], "gnn": [0, 9, 23], "transform": [0, 3, 7, 8, 9, 14, 16, 17, 23, 27, 31, 37], "util": [0, 1, 3, 4, 5, 7, 8, 9, 12, 35, 36, 37, 38], "synthet": [0, 3, 9, 29], "pseudo_st": [0, 9, 29, 33], "gbolt": [0, 9, 29], "metric": [0, 4, 9, 29, 35, 36], "misc": [0, 9, 29, 36], "plot": [0, 3, 9, 10, 26, 29, 31, 35, 37], "scmodel": [0, 8, 9, 10, 26, 35, 38, 39], "stmodel": [0, 9, 35, 36, 38], "functionalbas": [1, 7, 8, 12], "use_earlystop": [1, 4, 8, 38], "true": [1, 3, 4, 5, 7, 8, 10, 11, 14, 16, 17, 21, 22, 26, 27, 31, 32, 34, 36, 37, 38, 39], "devic": [1, 3, 5, 7, 8, 10, 25, 26], "none": [1, 3, 4, 5, 7, 8, 10, 11, 13, 14, 15, 16, 17, 19, 21, 24, 25, 26, 27, 31, 32, 34, 36, 37, 38], "modelop": [1, 3], "i": [1, 3, 4, 5, 7, 8, 10, 11, 14, 15, 16, 17, 21, 22, 24, 25, 26, 27, 30, 31, 35, 36, 37, 38, 39], "compound": 1, "combin": 1, "The": [1, 3, 4, 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 25, 26, 27, 31, 36, 37, 38], "train": [1, 3, 4, 5, 7, 8, 21, 22, 24, 36, 37, 38, 39], "type": [1, 3, 4, 5, 7, 8, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 25, 26, 27, 30, 31, 32, 34, 35], "split_rat": [1, 4, 5, 7, 8, 37, 38, 39], "ratio": [1, 4, 28], "valid": [1, 4, 5, 7, 11, 27, 37, 38, 39], "total": [1, 4, 37], "float": [1, 3, 4, 5, 7, 8, 14, 30, 32, 34, 38], "A": [1, 3, 4, 5, 7, 8, 13, 16, 27, 28, 38], "flag": [1, 3, 4, 7, 27], "indic": [1, 3, 4, 7, 8, 14, 17, 27, 37], "whether": [1, 3, 4, 5, 7, 8, 10, 14, 16, 17, 21, 22, 24, 26, 27, 31, 32, 37], "earli": [1, 4, 7, 8, 37, 38, 39], "stop": [1, 4, 7, 8, 15, 37, 38, 39], "dure": [1, 5, 10], "bool": [1, 3, 4, 5, 7, 8, 10, 14, 15, 16, 17, 21, 22, 24, 26, 27, 31, 32, 34], "default": [1, 3, 4, 5, 7, 8, 10, 11, 14, 16, 17, 19, 20, 21, 26, 27, 31, 37], "cuda": [1, 38, 39], "gpu": [1, 38, 39], "avail": [1, 7, 11], "otherwis": [1, 4, 7, 14, 16, 26], "cpu": [1, 38, 39], "str": [1, 3, 4, 5, 7, 8, 10, 12, 13, 14, 16, 17, 19, 25, 26, 27, 30, 31, 32, 34, 36, 37], "run": [1, 5, 7, 8, 35, 36, 37, 39], "adata": [1, 3, 4, 5, 7, 8, 10, 12, 19, 25, 26, 27, 30, 31, 32, 36, 37, 38, 39], "anndata": [1, 3, 5, 7, 8, 10, 12, 19, 25, 26, 27, 30, 31, 32, 34, 36, 37, 38], "basedataset": [1, 3, 4, 5, 7, 12, 27], "maskeddataset": [1, 4, 7, 27], "epoch": [1, 4, 5, 7, 8, 37, 38, 39], "1": [1, 4, 5, 7, 8, 11, 15, 16, 17, 20, 21, 22, 24, 28, 30, 32, 36, 37, 38, 39], "batch_siz": [1, 4, 5, 7, 8, 14, 37, 38, 39], "int": [1, 3, 4, 5, 7, 8, 10, 11, 13, 14, 16, 17, 19, 20, 21, 22, 25, 26, 27, 28, 30, 31, 34, 38], "0": [1, 3, 4, 5, 7, 8, 11, 14, 16, 21, 24, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39], "2": [1, 4, 5, 7, 10, 11, 14, 15, 17, 26, 28, 31, 32, 34, 36, 37, 38, 39], "key_ad": [1, 3, 5, 7, 8, 10, 26, 36, 37, 39], "x_rep": [1, 3, 5, 7, 19, 37, 38, 39], "obs_kei": [1, 4, 30, 32], "call_func": [1, 4, 7], "kl_cutoff": [1, 3, 5, 7, 8], "reset": [1, 3, 5, 7, 8], "fals": [1, 3, 4, 5, 7, 8, 10, 14, 15, 16, 17, 21, 25, 26, 27, 31, 32, 36, 37, 38, 39], "beta": [1, 3, 5, 7, 8, 25, 36, 38], "01": [1, 5, 7, 8, 25, 36, 37, 38], "lr": [1, 4, 5, 7, 8], "001": [1, 4, 5, 7, 8], "process": [1, 3, 4, 8, 11, 17, 27, 35, 37, 38], "paramet": [1, 3, 4, 5, 7, 8, 10, 11, 13, 14, 15, 16, 17, 19, 20, 21, 22, 24, 25, 26, 27, 30, 31, 32, 34, 37, 38], "annot": [1, 3, 5, 7, 8, 10, 19, 25, 26, 27, 30, 31, 32, 35, 37], "object": [1, 3, 4, 5, 7, 8, 10, 12, 16, 17, 19, 25, 26, 27, 31, 35, 36, 37], "union": [1, 4, 27, 34], "scdataset": [1, 3, 4, 7, 25, 27], "stdataset": [1, 4, 5, 8, 26, 27], "option": [1, 3, 4, 5, 7, 8, 10, 14, 16, 17, 19, 20, 25, 26, 27, 31, 37], "number": [1, 4, 5, 7, 8, 10, 11, 14, 15, 16, 17, 19, 20, 22, 26, 27, 28, 30, 31, 34, 36, 37, 38, 39], "size": [1, 3, 4, 5, 7, 8, 10, 15, 21, 26, 32, 34, 37, 38, 39], "split": [1, 4, 5, 7, 8, 37, 38, 39], "rate": [1, 3, 4, 5, 7, 8, 14, 15, 16, 21, 37], "test": [1, 5, 7], "kei": [1, 3, 4, 5, 7, 8, 10, 14, 26, 27, 30, 31, 32, 34, 36, 37, 38, 39], "store": [1, 3, 5, 7, 31, 37], "obsm": [1, 3, 7, 10, 26, 30, 31, 32, 36, 37, 39], "ob": [1, 4, 5, 7, 8, 10, 26, 30, 31, 32, 36, 37, 38], "callabl": [1, 4, 5, 7, 8], "callback": 1, "call": [1, 4, 11, 21, 22, 24], "after": [1, 4, 35], "each": [1, 4, 10, 14, 16, 31, 35], "kl": [1, 3, 5, 7, 8, 17, 37], "diverg": [1, 3, 17, 37], "cutoff": [1, 3, 5, 7, 8], "valu": [1, 3, 4, 5, 7, 8, 11, 14, 15, 16, 27, 30, 32, 37, 38], "learn": [1, 4, 5, 7, 8, 35, 37], "optim": [1, 4], "1e": [1, 5, 7, 8, 15, 36, 37, 38], "3": [1, 5, 7, 8, 10, 11, 17, 22, 24, 26, 32, 34, 36, 37, 38, 39], "load_checkpoint": [1, 5, 25], "checkpoint": [1, 4, 5], "load": [1, 4, 5, 10, 11, 25, 26, 31, 35], "file": [1, 5, 10, 11, 25, 26, 27, 31, 34], "updat": [1, 4, 5, 36, 38], "": [1, 3, 5, 11, 27, 30, 36, 37, 38, 39], "state": [1, 4, 5, 7, 16, 35], "dictionari": [1, 3, 4, 5, 7, 8, 11, 16], "path": [1, 4, 5, 10, 12, 25, 26, 27, 31, 36, 37], "return": [1, 3, 4, 5, 7, 8, 10, 11, 14, 15, 16, 17, 19, 20, 21, 22, 24, 25, 26, 27, 30, 31, 32, 34, 39], "wrap": [3, 32], "method": [3, 5, 7, 10, 13, 26, 27, 37], "set_kl_cutoff": 3, "set": [3, 4, 5, 7, 11, 27, 35, 36, 37, 39], "loss": [3, 4, 5, 7, 8, 14, 17, 37], "x": [3, 4, 7, 15, 16, 17, 21, 22, 24, 31, 38], "ind": [3, 4, 5, 8], "singl": [3, 5, 10, 25, 27, 34, 35, 38], "torch": [3, 4, 5, 7, 8, 14, 15, 16, 17, 21, 22, 24, 27, 31, 36, 37], "tensor": [3, 4, 5, 7, 8, 14, 15, 16, 17, 21, 31], "matrix": [3, 5, 7, 14, 17, 20, 26, 27, 30, 31, 32, 37], "loss_dict": [3, 4], "dict": [3, 4, 5, 7, 8, 10, 16, 17, 21, 31, 38], "loss_gbatch": [3, 8], "graph": [3, 4, 5, 8, 14, 17, 22, 28, 31, 36, 37, 38], "should": [3, 15, 21, 22, 24], "implement": [3, 7, 14], "deriv": [3, 39], "get_px": 3, "decode_dict": [3, 7], "get": [3, 5, 27, 35], "probabl": [3, 14, 15], "observ": [3, 15, 20, 31], "px": 3, "get_batch_ohenc": 3, "batch_label": [3, 17, 21, 27, 38, 39], "averag": [3, 10, 26, 35], "convert": [3, 5, 8, 11, 21, 22, 24, 27], "label": [3, 7, 8, 10, 27, 36, 37, 38, 39], "one": [3, 15, 31], "hot": 3, "encod": [3, 16, 17, 37], "format": [3, 4, 11, 31], "batch_oh": 3, "emb": [3, 7, 8], "tsfmr_out": [3, 7, 8, 16, 31], "as_numpi": [3, 7, 8], "represent": [3, 5, 7, 8, 16, 17, 19, 26, 27], "numpi": [3, 7, 8, 19, 31, 36, 37, 38, 39], "arrai": [3, 4, 7, 8], "rep": [3, 5, 7, 8, 27, 37], "add_emb": [3, 37], "add": [3, 5, 7, 8, 10, 26, 35, 37], "an": [3, 4, 7, 11, 14, 16, 21, 22, 24, 27, 35, 38, 39], "_type_": 3, "_description_": 3, "get_signatur": [3, 5], "batch_us": [3, 5, 39], "retriev": [3, 7, 27], "signatur": [3, 5, 14, 20, 37], "from": [3, 7, 8, 15, 17, 19, 27, 28, 31, 32, 36, 37, 38, 39], "given": [3, 4, 5, 7, 8, 14, 16, 30, 31, 38], "which": [3, 4, 10, 11, 15, 26, 27, 31, 38], "If": [3, 4, 7, 11, 15, 16, 26, 27], "use_batch_rep": 3, "set_kl_start": 3, "n_iter": [3, 8, 36, 38], "imput": [3, 5, 7, 37], "expected_count": [3, 7], "rep_kei": [3, 5, 7], "layer_kei": [3, 7, 10, 25, 26, 27, 34, 36, 37, 38, 39], "qc": [3, 5, 7, 37], "return_count": 3, "log10": [3, 32], "ndarrai": [3, 7, 19, 20, 27, 31, 32], "miss": [3, 7], "involv": [3, 37], "predict": [3, 7, 14, 16], "mean": [3, 15, 16, 17, 34, 36, 37], "access": 3, "layer": [3, 5, 7, 8, 14, 16, 17, 22, 27, 34, 36, 37, 38, 39], "onli": [3, 5, 17, 27, 34, 37, 38], "librari": [3, 5, 19, 21, 31, 32], "sequenc": [3, 10, 25, 26, 32], "depth": [3, 24], "normal": [3, 5, 15, 16, 17, 37], "qualiti": [3, 5, 7], "control": [3, 5, 7, 14, 15, 37], "count": [3, 5, 14, 31, 34, 36, 37, 38, 39], "generated_count": 3, "attribut": [3, 7, 10, 21, 22, 24], "provid": [3, 4, 7, 10, 15, 16, 26, 27, 38], "gene_expr": [3, 27, 38, 39], "regress_out": [3, 39], "library_s": [3, 5, 39], "100000": [3, 5], "corrected_count": [3, 39], "regress": 3, "out": [3, 7, 11, 14, 17, 37, 38, 39], "unwant": 3, "sourc": [3, 11], "variat": [3, 8, 10, 17, 26, 35, 38], "subtract": 3, "origin": [3, 27, 37], "abstract": [3, 5, 26, 27], "show_attn_map": 3, "get_gene_modul": 3, "loss_fn": 3, "decoder_typ": [3, 5, 10, 16, 17, 25, 36, 37, 38, 39], "px_r": [3, 16, 17], "px_rate": [3, 16], "px_dropout": [3, 16], "px_scale": [3, 16], "readout": [3, 5, 16, 17], "nokl": 3, "reduct": 3, "kwarg": [3, 4, 5, 7, 8, 10, 14, 16, 24, 25, 26, 27, 32, 34], "basic": 3, "reconstruct": [3, 37], "comput": [3, 4, 8, 11, 15, 17, 38, 39], "sum": 3, "neg": [3, 5, 15, 17, 20, 37], "log": [3, 5, 8, 11, 15, 27, 37], "likelihood": [3, 15, 37], "while": [3, 37], "kullback": 3, "leibler": 3, "between": [3, 14, 37], "approxim": 3, "posterior": [3, 32], "prior": 3, "estim": [3, 5, 21, 37], "logit": [3, 14, 15, 21], "dropout": [3, 15, 16, 21, 24], "over": [3, 14, 16], "dispers": [3, 8, 10, 15, 16, 25, 26, 36, 37, 38], "recon_loss": [3, 36, 37, 38, 39], "kl_loss": [3, 17, 36, 37, 38, 39], "scale": [3, 5, 14, 15, 16, 21, 31, 32, 37], "set_beta": 3, "factor": [3, 4, 5, 7, 31], "reset_model": [3, 7, 8], "train_loop_formatt": 4, "train_func": 4, "decor": 4, "loop": 4, "earlystop": [4, 37, 38, 39], "patienc": 4, "7": [4, 34, 36, 37, 38, 39], "verbos": [4, 11], "delta": 4, "pt": 4, "trace_func": 4, "print": [4, 36, 38, 39], "doesn": [4, 37], "t": [4, 5, 14, 24, 37, 39], "improv": [4, 7], "respons": [4, 11], "being": 4, "adam": 4, "lr_schedul": 4, "schedul": 4, "multisteplr": 4, "early_stop": 4, "lossconfig": 4, "configur": [4, 27], "differ": [4, 13, 35, 37, 38], "defualt_lcfg": 4, "mode_switch_to_train": 4, "init_optim": 4, "tune_lr": [4, 5, 7, 8, 37, 38], "0001": [4, 5, 7], "stage": [4, 37, 38], "tune_batch_embed": 4, "initi": [4, 10, 11, 16, 21, 35], "fine": [4, 5, 8], "tune": [4, 5, 7, 8, 37], "set_lr_schedul": 4, "_lrschedul": 4, "gamma": [4, 15], "decai": 4, "mileston": 4, "list": [4, 5, 7, 26, 27, 30, 31, 32], "update_model_param": 4, "setup_early_stop": 4, "up": [4, 35], "cum_loss": 4, "total_loss_dict": 4, "n_batch": 4, "n_epoch": 4, "cumul": 4, "current": [4, 8, 11, 16, 27, 38, 39], "check_early_stop": 4, "check": [4, 35, 39], "criteria": 4, "ar": [4, 7, 11, 13, 15, 27, 31, 37], "met": [4, 7], "format_loss_dict": 4, "valid_loss_dict": 4, "endepoch": 4, "displai": 4, "end": [4, 8, 38], "split_x": 4, "input": [4, 5, 7, 8, 14, 16, 17, 21, 22], "like": [4, 35], "tupl": [4, 7, 8, 10, 14, 15, 26, 27, 31, 32], "handle_input_tupl": [4, 7, 8], "input_tupl": [4, 5, 7, 8], "handl": [4, 7, 8], "calcul": [4, 7, 14, 30], "target": [4, 5, 7], "handle_ginput_tupl": [4, 5, 8], "train_batch": [4, 7], "loader": 4, "train_ind": [4, 7], "valid_ind": [4, 7], "addit": [4, 5, 7, 8, 14, 26, 27, 31, 32, 34], "keyword": [4, 5, 7, 8, 14, 26, 27], "argument": [4, 5, 7, 8, 11, 14, 15, 16, 17, 21, 26, 27, 32, 34], "pass": [4, 7, 14, 17, 21, 31], "condit": [4, 7, 27], "train_node_sampl": 4, "gloader": 4, "sampler": [4, 28], "dataload": [4, 5, 8, 28], "train_graph_batch": 4, "sampl": [4, 5, 8, 15, 27, 28, 35, 37, 38], "validate_load": 4, "evalu": [4, 15, 21, 22, 24, 35, 37], "iter": [4, 5, 8, 14, 16, 27, 37], "self": [4, 5, 14, 21, 22, 24, 26], "val_": 4, "metric_nam": 4, "validate_x": 4, "specifi": [4, 5, 10, 11, 16, 27, 37], "index": [4, 8, 26, 27, 37], "validate_gload": 4, "static": 4, "make_load": 4, "shuffl": 4, "creat": [4, 11, 16, 27], "column": [4, 5, 27, 31, 37], "category_random_split": 4, "categori": [4, 37, 38, 39], "crossmodalitynrml": [5, 10], "scmultibatchnrml": [5, 7, 25], "cross": [5, 27], "modal": [5, 27, 35], "transcriptom": [5, 8, 10, 26, 27, 34, 35], "need_anchor": [5, 7, 37], "anchor": [5, 7, 14, 16, 31, 37], "mixer": [5, 10, 14], "single_st": 5, "section": [5, 32, 35, 38], "st_decod": [5, 10], "stdecod": [5, 37], "max_neigh": 5, "maximum": [5, 14, 31, 34], "neighbor": [5, 19, 30, 31, 36, 37, 38, 39], "edge_clip": [5, 10, 17, 26, 31, 38], "edg": [5, 22, 31], "clip": [5, 31], "_num_batch": [5, 8], "_gener_graph": [5, 8], "_rout": 5, "nn": [5, 14, 16, 17, 21, 22, 24], "from_spatial_graph": [5, 8], "1024": [5, 8, 37, 38, 39], "num_it": [5, 8], "1000": [5, 8], "use_rep": [5, 7, 10, 19, 26, 36, 37, 38, 39], "batch_kei": [5, 8, 10, 25, 26, 27, 31, 32, 34, 36, 37, 38, 39], "inform": [5, 7, 8, 11, 26, 27, 31, 32, 37], "per": [5, 8, 14, 21, 22, 24], "add_embed_st": 5, "st_dataset": 5, "x_smooth": [5, 8, 10, 26, 36, 37, 38], "smooth": [5, 8, 16, 17, 34, 35, 37], "crossdataset": [5, 10, 27], "tune_epoch": [5, 7, 37, 38, 39], "20": [5, 7, 21, 22, 24, 37, 38, 39], "beta1": [5, 7, 37, 38], "beta2": [5, 7, 38], "4": [5, 7, 8, 22, 26, 32, 34, 36, 37, 38, 39], "anchors_onli": 5, "generate_domain": [5, 37], "zinb": [5, 10, 15, 17, 21, 25, 36, 37, 38], "smooth_epoch": [5, 8, 37], "200": [5, 34, 37], "n_dec_lay": [5, 37], "n_glayer": [5, 8, 14, 17, 26, 36, 37, 38], "dec_norm": [5, 17, 36, 37], "use_st_decod": [5, 37], "graph_batch_s": [5, 8, 36, 38], "st": [5, 37], "enabl": [5, 8, 16, 38, 39], "cell_type_kei": [5, 31, 34], "domain_wis": [5, 14, 37], "domain_kei": [5, 10, 26, 32, 34, 37], "solver": [5, 14], "attn": [5, 14], "max_ct_per_spot": [5, 14], "hard_anchor": [5, 14, 37], "sc_consist": [5, 14, 37], "alpha": [5, 14], "use_raw": [5, 37], "liter": [5, 7, 16, 17, 21], "deconvolut": [5, 20, 26, 32, 35], "wise": [5, 14, 37], "1e5": [5, 39], "spot": [5, 14, 31, 35, 37], "hard": [5, 7, 14], "consist": [5, 14, 17], "raw": [5, 37], "temperatur": [5, 14, 37], "07": [5, 14, 38, 39], "nnls_deconv": [5, 20], "n_job": [5, 20, 38, 39], "non": [5, 16, 17, 20, 38], "least": [5, 20], "squar": [5, 20], "job": [5, 20], "parallel": 5, "reference_map": 5, "k": [5, 14, 19, 30], "6": [5, 19, 31, 36, 37, 38, 39], "library_id": [5, 19, 31, 32, 36], "map": [5, 19], "refer": [5, 35, 37], "nearest": [5, 19, 30], "knn": 5, "algorithm": [5, 13], "consid": [5, 30, 37], "id": [5, 11, 19, 28, 31, 32], "ad": [5, 7, 26, 36, 37, 38], "finetun": [5, 7], "unlabeled_kei": [5, 7], "unlabel": [5, 7], "groupbi": [5, 7, 37], "group": [5, 7, 37], "get_pz": 5, "colnam": 5, "get_prop": [5, 14], "rownam": 5, "phat": [5, 14], "norm": [5, 21], "ct_scale": [5, 14], "proport": [5, 32, 34, 35], "name": [5, 10, 11, 25, 26, 27, 31, 32, 36, 37, 38], "result": [5, 7, 11, 16, 26, 32, 35, 36, 38], "datafram": [5, 27], "row": 5, "pd": [5, 27, 36, 37, 38, 39], "get_scor": [5, 14], "score": [5, 14], "panda": [5, 27, 36, 37, 38, 39], "st_imput": [5, 37], "st_expected_count": [5, 37], "appli": [5, 14, 16, 27], "obtain": [5, 35, 36], "pathlib": [5, 10, 12, 25, 26, 31], "scsinglebatch": [7, 25], "num_batch": [7, 8, 16, 17, 21, 27], "multi": [7, 27], "interfac": 7, "backbon": [7, 10], "nrmlsbc": [7, 8, 16], "_factor": [7, 8], "batch_rep": [7, 8, 16, 17], "class_label": [7, 27, 38, 39], "intern": 7, "select": [7, 14, 27, 35], "semi": 7, "supervis": 7, "unsupervis": 7, "see": [7, 31, 36, 37, 38], "parent": [7, 21, 22, 24], "output": [7, 8, 14, 16, 17, 21, 27, 31], "get_anchor": 7, "400": [7, 37, 38, 39], "512": 7, "100": [7, 36, 37, 38, 39], "refin": [7, 37], "x_anchord": [7, 38, 39], "when": [7, 11, 21, 22, 24, 31, 37], "e": [7, 11, 37], "classif": [7, 16, 17], "clsf": 7, "soft": 7, "pred_celltyp": 7, "either": [7, 10, 11], "pred": 7, "clsf_": 7, "softmax": [7, 17, 21], "head": [7, 14, 16, 24, 38], "infer": [7, 14, 35], "specif": [7, 27, 37], "_emb": 7, "super": [7, 21, 22, 24], "re": [7, 38], "stsmoother": [8, 26], "identifi": [8, 27, 31, 37, 38], "_from_scmodel": 8, "sample_r": 8, "g": [8, 11, 14, 17, 22, 28], "x_gd": [8, 16, 17], "dgl": [8, 17, 28, 31], "dglgraph": [8, 17], "featur": [8, 14, 15, 22, 26, 31, 32, 37, 38], "necessari": [8, 37], "oper": [8, 11, 16], "gemb": 8, "n_sampl": [8, 36], "2000": [8, 10, 17, 25, 26, 27, 36, 37, 38, 39], "05": [8, 36, 37, 38], "e2": [8, 35, 36], "contrast": [8, 14, 37, 38], "kl_contrast": 8, "5": [8, 10, 21, 22, 24, 26, 31, 32, 34, 36, 37, 38, 39], "kl_anneal": 8, "anneal": 8, "crossmodel": [10, 37], "sc_adata": [10, 27, 37], "st_adata": [10, 27, 37], "class_kei": [10, 25, 27, 37, 38, 39], "n_top_gen": [10, 25, 26, 27, 36, 37, 38], "geneset_to_us": [10, 25, 26, 38], "st_sample_nam": [10, 27], "coord_kei": [10, 26, 27, 30, 38], "array_row": [10, 26, 27, 36, 37], "array_col": [10, 26, 27, 36, 37], "log_transform": [10, 25, 26, 27, 36, 37, 38, 39], "module_dim": [10, 17, 25, 26, 36, 37, 38, 39], "30": [10, 17, 25, 26, 36, 37, 38, 39], "decoder_input_dim": [10, 17, 25, 26, 38], "hidden_dim": [10, 14, 17, 21, 24, 25, 26, 36, 37, 38, 39], "64": [10, 21, 24, 25, 26, 36, 37, 38, 39], "n_modul": [10, 17, 25, 26, 36, 37, 38, 39], "32": [10, 25, 26, 37, 38, 39], "model_checkpoint": [10, 25, 26, 37], "st_batch_kei": [10, 27], "logarithm_first": [10, 25, 26, 27], "hvg_method": [10, 25, 26, 27], "seurat_v3": [10, 25, 26, 27, 36, 39], "filter": [10, 25, 26, 27, 31, 38], "main": [10, 25, 26], "rna": [10, 25, 35], "_function": [10, 25, 26, 37], "properti": [10, 14, 15, 16, 25, 26, 27], "cluster": [10, 13, 26, 35, 36, 37], "n_cluster": [10, 13, 26, 36, 37, 38], "kmean": [10, 13, 26, 37], "mclust": [10, 13], "sub_clust": [10, 26, 37], "pre_kei": [10, 26, 37], "sub_domain": [10, 26, 37], "sub": [10, 26, 34, 37], "summarize_domain": [10, 26, 37], "cell_type_nam": [10, 26, 32], "obsm_kei": [10, 26, 32], "figsiz": [10, 26, 32, 36, 38], "15": [10, 26, 37, 38, 39], "show": [10, 26, 32, 38, 39], "summar": [10, 26, 35], "quantif": 10, "figur": [10, 26, 32, 37, 39], "summarize_single_domain": [10, 26], "save_adata": 10, "classmethod": [10, 12, 25, 26, 27], "config_nam": [10, 25, 26], "config": [10, 25, 26, 35, 36], "json": [10, 25, 26], "model_nam": [10, 25, 26], "pth": [10, 25, 26, 37], "st_decoder_nam": 10, "mixer_nam": 10, "filepath": [10, 25, 26], "spatial_plot": [10, 26, 32, 38], "slide": [10, 26, 32], "with_imag": [10, 26, 32, 38], "logger": 11, "ch": 11, "customformatt": 11, "fmt": 11, "datefmt": 11, "style": 11, "formatt": 11, "instanc": [11, 16, 35], "logrecord": 11, "text": [11, 15], "need": 11, "know": 11, "construct": [11, 36], "thei": [11, 37], "usual": 11, "string": [11, 27], "can": [11, 21, 22, 24, 31, 37, 38], "interpret": 11, "extern": [11, 39], "system": 11, "allow": [11, 21, 22, 24], "suppli": 11, "depend": 11, "messag": 11, "make": 11, "knowledg": 11, "mention": 11, "abov": [11, 21, 22, 24], "fact": 11, "user": [11, 38], "pre": [11, 26], "describ": 11, "channel": 11, "levelno": 11, "numer": [11, 15], "debug": 11, "info": [11, 34, 36, 37, 38, 39], "warn": [11, 37, 38, 39], "error": 11, "critic": 11, "levelnam": 11, "pathnam": 11, "full": 11, "where": [11, 15, 31, 37], "wa": 11, "issu": 11, "filenam": 11, "portion": 11, "lineno": 11, "d": 11, "line": 11, "funcnam": 11, "f": [11, 14, 21, 22, 24, 36, 37, 38, 39], "time": [11, 16], "asctim": 11, "textual": 11, "msec": 11, "millisecond": 11, "creation": 11, "relativecr": 11, "rel": 11, "typic": [11, 31], "applic": 11, "startup": 11, "thread": 11, "threadnam": 11, "record": 11, "getmessag": 11, "just": 11, "emit": 11, "operand": 11, "yield": 11, "befor": [11, 21, 22, 24, 27], "coupl": 11, "preparatori": 11, "carri": 11, "determin": 11, "usestim": 11, "formattim": 11, "event": 11, "except": [11, 27], "formatexcept": 11, "append": [11, 36], "set_verbos": 11, "saver": 12, "class_nam": 12, "funcmodel": 12, "get_inst": 12, "mclust_r": 13, "num_clust": 13, "modelnam": 13, "eee": 13, "random_se": 13, "2020": 13, "same": [13, 16, 37], "those": 13, "r": 13, "packag": [13, 35, 36, 38], "seed": [13, 26, 31], "clustergener": 13, "support": [13, 15, 16], "random": [13, 19, 26, 28, 37, 38, 39], "topnattent": 14, "top_n": 14, "num_head": [14, 31], "embed_dim": 14, "activ": [14, 16, 17, 21], "relu": [14, 16, 21, 22, 24], "top": [14, 27], "n": 14, "spars": [14, 37], "attent": [14, 24, 37], "mechan": [14, 37], "dimens": [14, 16, 17, 22, 37], "q": 14, "linear": [14, 16, 17], "queri": 14, "kv": 14, "act": [14, 16], "ani": [14, 16, 26, 31, 37], "forward": [14, 16, 17, 21, 22, 24], "v": 14, "n_spot": 14, "smoother": [14, 16, 17, 37], "use_smooth": [14, 17], "8": [14, 17, 24, 36, 37, 38], "hidden": [14, 17, 22, 37], "n_layer": [14, 22], "adjust": [14, 37], "sparsiti": [14, 37], "final": [14, 37], "08": [14, 15, 39], "anchors_": 14, "h": [14, 17], "similar": [14, 37], "ts_forward": 14, "return_anchor": 14, "inf_pz": 14, "spot_logit": 14, "anchors_logit": 14, "pz": 14, "p_hat": 14, "ct": 14, "mask_prop": 14, "prop": 14, "mask": [14, 27, 31], "ct_per_spot": 14, "top_n_anchor": 14, "shape": [14, 15, 26], "num_anchor": 14, "embedding_dim": 14, "repres": [14, 21, 22, 24, 27], "posit": [14, 15], "coef": 14, "param": 14, "phat_param": 14, "st_scale": 14, "log_zinb_posit": 15, "mu": [15, 32], "theta": 15, "pi": 15, "ep": 15, "scvi": 15, "scalar": 15, "minibatch": 15, "accord": [15, 37], "binomi": [15, 17], "ha": [15, 38], "var": [15, 31, 36, 37], "invers": 15, "real": 15, "stabil": 15, "constant": 15, "note": [15, 36, 37, 38], "we": [15, 37, 38], "parametr": 15, "bernoulli": 15, "henc": 15, "softplu": [15, 17, 21], "appear": 15, "log_nb_posit": 15, "nb": [15, 21, 37, 39], "log_mixture_nb": 15, "mu_1": 15, "mu_2": 15, "theta_1": 15, "theta_2": 15, "pi_logit": 15, "mixtur": 15, "first": [15, 27, 38], "compon": [15, 38], "For": [15, 37, 38], "totalvi": 15, "background": 15, "second": 15, "assum": 15, "share": [15, 37], "belong": 15, "negativebinomi": 15, "total_count": 15, "prob": 15, "validate_arg": 15, "One": 15, "follow": [15, 31, 37], "parameter": 15, "must": [15, 21, 22, 24], "failur": 15, "until": 15, "experi": 15, "success": 15, "tool": [15, 35], "These": 15, "respect": 15, "In": [15, 31, 37, 38], "w": 15, "sim": 15, "textrm": 15, "underbrac": 15, "poisson": 15, "rais": [15, 27], "valueerror": 15, "do": 15, "match": [15, 27, 38], "constraint": 15, "varianc": [15, 36], "arg_constraint": 15, "sample_shap": 15, "rsampl": 15, "log_prob": 15, "densiti": 15, "mass": 15, "pearson_residu": 15, "pearson": 15, "residu": 15, "zeroinflatednegativebinomi": 15, "zi_logit": 15, "zero": [15, 17], "inflat": [15, 17], "zi": 15, "zi_prob": 15, "batchawarescal": 16, "input_dim": [16, 17, 21, 38], "output_dim": [16, 17, 21], "introduc": [16, 35], "paper": [16, 36, 37], "net": [16, 17], "neural": [16, 17, 21, 22, 24], "network": [16, 17, 21, 22, 24], "sequenti": [16, 17], "batchawarelayernorm": 16, "layernorm": [16, 17, 37], "num_class": [16, 27], "use_l_scal": [16, 17, 21], "awar": 16, "elimin": [16, 37, 38], "effect": [16, 37, 38], "batch_emb_dim": 16, "batch_embed": 16, "batch_readout": 16, "arg": [16, 17, 21], "non_decoder_param": 16, "includ": [16, 27, 31], "expand": [16, 17], "encode_t": [16, 17], "readout_": [16, 17], "readout_batch": 16, "rep_t": [16, 17], "cls_rep": [16, 17], "decode_t": [16, 17], "decode_skip": 16, "skip": [16, 21], "seri": [16, 27], "decode_": 16, "return_exp": 16, "init_anchor": 16, "new_anchor": 16, "greater": 16, "than": 16, "accordingli": 16, "new": [16, 27], "successfulli": [16, 37], "copi": [16, 17, 21], "with_stat": [16, 17], "copy_dec": 16, "regist": [16, 21, 22, 24], "moduledict": 16, "drop_edg": 17, "linear2d": 17, "bia": 17, "3d": 17, "weight": [17, 31], "logvar": 17, "clear": 17, "genemodul": 17, "16": [17, 36, 37, 38, 39], "take": 17, "extractor": 17, "demodul": 17, "random_permut": 17, "use_p": 17, "use_skip": [17, 21], "256": 17, "nhead": 17, "n_enc_lay": 17, "gcn": [17, 22, 37], "dec_hidden_dim": 17, "n_dec_hid_lay": [17, 37, 38], "architectur": 17, "transformerencod": 17, "cls_token": 17, "token": 17, "probdecod": [17, 21], "_smooth": 17, "smoother_typ": 17, "garg": 17, "get_px_r": 17, "init_smoother_with_builtin": 17, "init_smooth": 17, "local_smooth": 17, "local": 17, "denot": [17, 37], "standard": 17, "bacth_rep": 17, "start": [17, 37], "knn_random_coord": 19, "y_spatial": 19, "assign": [19, 21, 22, 24], "coordin": [19, 27, 30, 31, 32], "np": [19, 20, 27, 32, 36, 37, 38, 39], "exp": 21, "all": [21, 22, 24, 27, 28, 38, 39], "your": [21, 22, 24, 37], "also": [21, 22, 24, 37], "subclass": [21, 22, 24], "other": [21, 22, 24, 37], "nest": [21, 22, 24], "them": [21, 22, 24, 35], "tree": [21, 22, 24], "structur": [21, 22, 24, 37], "you": [21, 22, 24], "submodul": [21, 22, 24, 35], "regular": [21, 22, 24, 31, 37], "import": [21, 22, 24, 36, 37, 38, 39], "def": [21, 22, 24, 39], "__init__": [21, 22, 24], "conv1": [21, 22, 24], "conv2d": [21, 22, 24], "conv2": [21, 22, 24], "wai": [21, 22, 24], "have": [21, 22, 24], "too": [21, 22, 24], "etc": [21, 22, 24, 37], "As": [21, 22, 24, 37], "exampl": [21, 22, 24], "made": [21, 22, 24], "child": [21, 22, 24], "variabl": [21, 22, 24, 27, 30, 31], "boolean": [21, 22, 24], "mode": [21, 22, 24, 27, 28, 35, 39], "3000": [21, 36], "128": 21, "n_hidden_lay": 21, "dist": 21, "skip_dim": 21, "probabilist": 21, "z": 21, "z_": 21, "connect": 21, "ffn_": 21, "feedforward": [21, 24], "dropout_": 21, "logoit": 21, "with_param": 21, "gat": 22, "in_feat": 22, "h_feat": 22, "n_head": 22, "with_edg": 22, "convolut": [22, 37], "exist": [24, 37], "val": 24, "pair": 24, "softmax_on": 24, "dim": 24, "_stacklevel": 24, "dtype": [24, 36, 37], "prenorm": 24, "fn": 24, "dim_head": 24, "mlp_dim": 24, "file_path": [25, 26, 36, 38, 39], "n_ob": [26, 36, 37], "n_var": [26, 36, 37], "wrapper": 26, "imag": [26, 31], "scanpi": [26, 31, 32, 36, 37, 38, 39], "pl": [26, 32, 36, 37, 38, 39], "matplotlib": [26, 32, 36, 37, 38, 39], "process_field": 27, "is_human": 27, "geneset": [27, 37, 38], "read_field": 27, "recieve_field": 27, "_batch_cod": 27, "scmode": 27, "enum": 27, "single_batch": 27, "field": 27, "multi_batch": [27, 38, 39], "multi_batches_with_ct": [27, 38, 39], "stmode": 27, "with_rep": 27, "with_domain": 27, "original_dataset": 27, "subset": [27, 37], "_indic": 27, "_mask": 27, "masked_num_batch": 27, "masked_num_class": 27, "set_mod": 27, "previou": [27, 37], "col": [27, 36], "exclud": 27, "read": [27, 31, 37], "receiv": 27, "read_fold": 27, "folder": [27, 31], "logarithm": 27, "highli": 27, "batch_cod": 27, "code": [27, 36, 37, 38], "batch_nam": 27, "class_cod": 27, "n_gene": [27, 31, 36, 37, 38], "process_config": 27, "attr": 27, "switch_lay": 27, "set_domain": 27, "set_prior_coef": 27, "prior_coef": 27, "_integr": 27, "st_batch_cod": 27, "st_sample_list": 27, "num_st_batch": 27, "set_rep": 27, "correspond": [27, 37], "subset_st": 27, "sole": [27, 37], "multigraphsallnodessampl": 28, "budget": 28, "n_graph": 28, "saintsampl": 28, "custom": 28, "node_sampl": 28, "moran_i": 30, "moran": 30, "interest": 30, "geary_c": 30, "geari": 30, "c": [30, 38], "set_se": [31, 36], "get_de_gen": 31, "de_kei": 31, "rank_genes_groups_filt": 31, "10": [31, 32, 36, 37, 38, 39], "log2fc_cutoff": 31, "hvg_intersect": 31, "compute_selfattent": 31, "transformer_encod": 31, "src_key_padding_mask": 31, "i_lay": 31, "d_model": 31, "extract_selfattention_map": 31, "generate_adj": 31, "max_neighbor": [31, 38], "dglheterograph": 31, "distanc": 31, "aver_items_by_ct": 31, "item": 31, "return_ct": 31, "aggreg": 31, "along": 31, "read_visium_hd": 31, "genom": [31, 36, 37], "count_fil": 31, "filtered_feature_bc_matrix": 31, "h5": 31, "load_imag": 31, "source_image_path": 31, "visum": 31, "hd": 31, "modifi": 31, "read_visium": 31, "look": 31, "space": [31, 37], "ranger": 31, "doc": 31, "compat": 31, "directori": 31, "datafil": 31, "within": 31, "would": 31, "raw_feature_bc_matrix": 31, "concaten": 31, "high": 31, "resolut": [31, 38], "tissu": 31, "un": [31, 36, 37], "metadata": 31, "barcod": 31, "obs_nam": 31, "var_nam": [31, 37, 38], "probe": 31, "bc": 31, "gene_id": [31, 36, 37], "feature_typ": [31, 36, 37], "filtered_barcod": 31, "present": [31, 38, 39], "spacerang": 31, "hire": 31, "lowr": 31, "scalefactor": 31, "chemistry_descript": 31, "software_vers": 31, "usabl": 31, "basi": 31, "title_prefix": 32, "ax": 32, "pyplot": [32, 36, 37, 38, 39], "bacth_kei": 32, "plot_spatial_pie_chart": 32, "spatial_kei": 32, "deconv_kei": 32, "pie": 32, "chart": 32, "plot_posterior_mu_vs_data": [32, 37], "cell2loc": [32, 37], "utils_plot": 32, "expect": 32, "against": 32, "plot_domain_summari": 32, "summari": 32, "plot_domain_summary_single_ct": 32, "plot_func": 32, "sc": [32, 36, 37, 38, 39], "plot_single_domain_summari": 32, "set_cmap": 32, "color_map": 32, "revers": 32, "plot_trajectori": 32, "pseudotim": 32, "locat": [32, 35, 37], "clusterlabel": 32, "gridnum": 32, "pointsiz": 32, "arrowlength": 32, "arrow_color": 32, "red": 32, "save_endpoint": 32, "plot_trajectory_curv": 32, "n_quantil": 32, "order": 32, "num_t": 32, "pseudost": 34, "adata_sc": 34, "adata_st": 34, "k_hop": 34, "downsapmle_s": 34, "cell_typ": 34, "sub_type_kei": 34, "coords_kei": 34, "info_kei": 34, "pseudo": 34, "hop": 34, "downsampl": 34, "coord": 34, "simul": 34, "mean_prop": 34, "75": 34, "min_cel": 34, "max_cel": 34, "max_num_major_typ": 34, "max_rank": 34, "prop_kei": 34, "ct_composit": 34, "abund_kei": 34, "ct_abund": 34, "sub_domain_kei": 34, "max_num_major_subtyp": 34, "major": [34, 37], "minimum": 34, "rank": 34, "minor": 34, "composit": [34, 35], "abund": 34, "st_onli": 34, "acronym": 35, "procedur": 35, "deep": [35, 38], "resolv": 35, "srt": 35, "unifi": 35, "approach": 35, "analyz": [35, 38], "well": 35, "align": 35, "sever": [35, 37], "disregard": 35, "relationship": [35, 38], "furthermor": 35, "conduct": [35, 37], "across": [35, 38], "tutori": [35, 37, 38], "151673": 35, "without": 35, "151676": 35, "togeth": 35, "ari": [35, 38], "na": 35, "co": 35, "two": 35, "zonat": 35, "visual": 35, "de": 35, "anlaysi": 35, "setup": 35, "direct": 35, "zone": 35, "compar": 35, "api": 35, "subpackag": 35, "o": [36, 37, 38], "seaborn": [36, 37, 38, 39], "sn": [36, 37, 38, 39], "plt": [36, 37, 38, 39], "sklearn": [36, 38], "adjusted_rand_scor": [36, 38], "figdir": [36, 38, 39], "dlpfc": 36, "set_figure_param": [36, 38, 39], "dpi_sav": [36, 38, 39], "300": [36, 38, 39], "project": [36, 38], "82505004": [36, 38], "e7a0": [36, 38], "445f": [36, 38], "ab3c": [36, 38], "80d03c91438f": [36, 38], "cach": [36, 38], "pypoetri": [36, 38], "virtualenv": [36, 38], "ajq_bw_i": [36, 38], "py3": [36, 38], "lib": [36, 38], "python3": [36, 38], "site": [36, 38], "tqdm": [36, 38], "py": [36, 38], "21": [36, 37, 38], "tqdmwarn": [36, 38], "iprogress": [36, 38], "found": [36, 38, 39], "pleas": [36, 38], "jupyt": [36, 38], "ipywidget": [36, 38], "http": [36, 37, 38], "readthedoc": [36, 38], "io": [36, 38], "en": [36, 38], "stabl": [36, 38], "user_instal": [36, 38], "html": [36, 38], "autonotebook": [36, 38], "notebook_tqdm": [36, 38], "chdir": 36, "expandus": 36, "case": 36, "studi": 36, "42": 36, "stepc": [36, 38, 39], "151673_annot": 36, "h5ad": [36, 37, 38, 39], "try": [36, 39], "hvg": [36, 37, 39], "39": [36, 37, 38, 39], "done": [36, 37, 38], "class": [36, 37, 38, 39], "expr": [36, 37, 38, 39], "3639": 36, "Not": 36, "vae": 36, "pattern": [36, 38], "19": [36, 37, 38, 39], "lt": [36, 37, 38, 39], "00": [36, 37, 38, 39], "37": [36, 38], "96step": 36, "1622": 36, "729": 36, "contrast_loss": [36, 37, 38], "130": 36, "graph_id": 36, "in_tissu": [36, 37, 38], "gd": 36, "mt_gene": [36, 37], "highly_vari": 36, "highly_variable_rank": 36, "variances_norm": 36, "log1p": 36, "mt": [36, 37], "cluster_": 36, "pp": [36, 37, 38, 39], "n_neighbor": 36, "tl": [36, 37, 38, 39], "umap": [36, 37, 38, 39], "9": [36, 37, 38], "color": [36, 37, 38, 39], "11": [36, 37, 38], "cat": [36, 37, 38], "6415591888519586": 36, "123456": 36, "2400": 36, "3400": 36, "03": [36, 38], "18": [36, 37, 38], "71step": 36, "2270": 36, "652": 36, "142": 36, "006": 36, "6854871224605329": 36, "_annot": 36, "rang": 36, "151677": 36, "read_h5ad": [36, 38, 39], "enumer": 36, "concat": 36, "uns_merg": 36, "uniqu": [36, 38], "dict_kei": 36, "151674": 36, "151675": 36, "value_count": [36, 37], "3673": 36, "3592": 36, "3460": 36, "int64": [36, 37], "14364": 36, "were": 36, "04": [36, 37, 38], "14step": 36, "1045": 36, "916": 36, "002": 36, "579": 36, "_adata": [36, 38], "6859044700752418": 36, "6737134878196837": 36, "6574160363368401": 36, "645033638093529": 36, "60": [36, 38], "ari_kmean": 36, "img_kei": 36, "titl": [36, 37, 38], "_ari_": 36, "2f": 36, "reuslt": 36, "p3": 36, "693643745029269": 36, "6823133597364682": 36, "6644988100827957": 36, "6493974579858672": 36, "showcas": 37, "workflow": 37, "firstli": 37, "latent": 37, "subdomain": 37, "subsequ": [37, 38], "sc_file": 37, "human_lymph_integr": 37, "sc_pth": 37, "st_pth": 37, "human_lymph_st_decod": 37, "st_file": [37, 38], "human_lymph_filt": 37, "makedir": 37, "part": 37, "adata_ref": 37, "lymph_sc": 37, "backup_url": 37, "cog": 37, "sanger": 37, "ac": 37, "uk": 37, "integrated_lymphoid_organ_scrna": 37, "regressionnbv4torch_57covariates_73260cells_10237gen": 37, "adata_vi": 37, "visium_sg": 37, "sample_id": 37, "v1_human_lymph_nod": 37, "var_names_make_uniqu": 37, "symbol": 37, "set_index": 37, "drop": 37, "inplac": 37, "renam": 37, "geneid": 37, "delet": 37, "unnecessari": 37, "slot": 37, "remov": 37, "futur": 37, "version": 37, "del": 37, "requir": 37, "annoat": 37, "about": 37, "n_moudl": 37, "batchnorm": 37, "proc": 37, "bcp005_total": 37, "13323": 37, "bcp006_total": 37, "4531": 37, "4861stdy7462253": 37, "4286": 37, "4861stdy7462255": 37, "4283": 37, "4035": 37, "4861stdy7528597": 37, "3888": 37, "bcp009_total": 37, "3867": 37, "4861stdy7462256": 37, "3852": 37, "4861stdy7528600": 37, "3594": 37, "4861stdy7528599": 37, "3172": 37, "4861stdy7135914": 37, "3126": 37, "4861stdy7462254": 37, "3085": 37, "4861stdy7528598": 37, "2961": [37, 38], "4861stdy7135913": 37, "2941": 37, "bcp008_total": 37, "2914": 37, "pan_t7935494": 37, "2876": 37, "bcp003_total": 37, "2083": 37, "bcp002_total": 37, "2002": 37, "human_colon_16s8000484": 37, "1308": 37, "4861stdy7208413": 37, "1228": 37, "4861stdy7208412": 37, "1130": 37, "human_colon_16s7255678": 37, "1125": 37, "bcp004_total": 37, "985": 37, "human_colon_16s7255677": 37, "700": 37, "goal": 37, "extract": 37, "transcript": 37, "technic": 37, "meantim": 37, "so": 37, "differenti": 37, "ignor": [37, 38], "somewhat": 37, "special": 37, "coeffici": 37, "chang": 37, "degre": 37, "higher": 37, "lower": 37, "2048": [37, 38], "2352": 37, "2500": 37, "904": 37, "982": 37, "3428": 37, "2468": 37, "3426": 37, "3081": 37, "3110": 37, "2368": 37, "2537": 37, "2875": 37, "1601": 37, "1666": 37, "788": 37, "10658": 37, "3624": 37, "2331": 37, "3093": 37, "560": 37, "900": 37, "1046": 37, "2300": 37, "3228": 37, "61826": 37, "15469": 37, "86": [37, 38], "344": 37, "27": [37, 38, 39], "23": 37, "78": [37, 38], "198": 37, "1147": 37, "656": 37, "val_kl_loss": [37, 38, 39], "229": 37, "233": [37, 38], "val_recon_loss": [37, 38, 39], "362": 37, "1143": 37, "838": 37, "trigger": [37, 38, 39], "counter": [37, 38, 39], "examin": 37, "mix": 37, "left": 37, "moreov": 37, "right": 37, "preserv": 37, "meaning": 37, "12": [37, 38], "ncol": 37, "13": [37, 38], "state_dict": 37, "produc": 37, "paramt": [37, 38], "desir": 37, "transcprit": 37, "achiev": 37, "trane": 37, "concentr": 37, "still": 37, "context": [37, 38], "fit": 37, "14": [37, 38], "800": [37, 38], "24": [37, 38, 39], "34": [37, 39], "58": 37, "63epoch": 37, "4178": 37, "889": 37, "47": 37, "79epoch": 37, "846": 37, "4188": 37, "098": 37, "val_contrast_loss": [37, 38], "defualt": 37, "here": 37, "further": 37, "through": [37, 38], "previous": 37, "17": [37, 38], "sinc": 37, "mainli": 37, "measur": 37, "ensur": 37, "occur": 37, "To": 37, "individu": 37, "disabl": 37, "And": 37, "bound": 37, "actual": 37, "simlar": 37, "minim": 37, "averg": 37, "balanc": 37, "lossess": 37, "sub_domain_cod": 37, "36epoch": 37, "div": 37, "186": 37, "loss_ori": 37, "250": 37, "2080": 37, "224": 37, "709": 37, "val_div": 37, "val_loss_ori": 37, "val_sc_consist": 37, "celltyp": 37, "prop_list": 37, "to_list": 37, "batch_st": 37, "b_cycl": 37, "b_gc_dz": 37, "b_gc_lz": 37, "b_gc_prepb": 37, "b_ifn": 37, "b_activ": 37, "b_mem": 37, "b_naiv": 37, "b_plasma": 37, "b_pregc": 37, "dc_ccr7": 37, "dc_cdc1": 37, "dc_cdc2": 37, "dc_pdc": 37, "endo": 37, "fdc": 37, "ilc": 37, "macrophages_m1": 37, "macrophages_m2": 37, "mast": 37, "monocyt": [37, 39], "nk": [37, 39], "nkt": [37, 39], "t_cd4": 37, "_tfh": 37, "_tfh_gc": 37, "_naiv": 37, "t_cd8": 37, "_cd161": 37, "_cytotox": 37, "t_tim3": 37, "t_tfr": 37, "t_treg": 37, "vsmc": 37, "domain_color": 37, "sub_domain_color": 37, "x_rep_tsfmr": 37, "deconv_abund": 37, "22": [37, 38], "astyp": [37, 38], "dendrogram": 37, "rank_genes_group": 37, "wilcoxon": 37, "rank_genes_groups_matrixplot": 37, "values_to_plot": 37, "logfoldchang": 37, "cmap": [37, 38], "rdbu_r": 37, "vmin": 37, "vmax": 37, "reorder": 37, "becaus": 37, "var_group_label": 37, "mainplot_ax": 37, "axessubplot": 37, "gt": [37, 38, 39], "group_extra_ax": 37, "gene_group_ax": 37, "color_legend_ax": 37, "center": 37, "fold": 37, "25": [37, 38, 39], "gc": 37, "showca": 38, "been": 38, "design": 38, "shed": 38, "light": 38, "aspect": 38, "cellular": 38, "complex": 38, "captur": 38, "genet": 38, "facilit": 38, "understand": 38, "among": 38, "streamlin": 38, "directli": 38, "aim": 38, "guid": 38, "capabl": 38, "dive": 38, "intricaci": 38, "merfish_animal1": 38, "hetorogen": 38, "focu": 38, "transcipt": 38, "potenti": 38, "even": 38, "though": 38, "resovl": 38, "due": 38, "limit": 38, "techniqu": 38, "161": 38, "fewer": 38, "bregma": 38, "cell_class": 38, "28316": 38, "animal_id": 38, "animal_sex": 38, "behavior": 38, "centroid_x": 38, "centroid_i": 38, "neuron_cluster_id": 38, "cell_id": 38, "6c59b1ec": 38, "95df": 38, "4f25": 38, "882a": 38, "ac94d99b87d8": 38, "femal": 38, "naiv": 38, "3033": 38, "401378": 38, "2825": 38, "155877": 38, "endotheli": 38, "nan": 38, "29": [38, 39], "aa7ce410": 38, "c485": 38, "42c9": 38, "9c29": 38, "bc1d90a46e00": 38, "3027": 38, "328655": 38, "2955": 38, "936449": 38, "inhibitori": 38, "61": 38, "8426329e": 38, "077b": 38, "4385": 38, "bd94": 38, "c9fdaeb89bd1": 38, "3020": 38, "512953": 38, "696710": 38, "54": 38, "a7e4e0d": 38, "8baa": 38, "4136": 38, "8cac": 38, "fa9bc759e7e8": 38, "3017": 38, "397490": 38, "2995": 38, "915801": 38, "c55468d5": 38, "1b2c": 38, "4477": 38, "b4ad": 38, "3653f5bbda35": 38, "3005": 38, "478613": 38, "2877": 38, "528929": 38, "40": 38, "4434": 38, "4641": 38, "4740": 38, "09": 38, "4445": 38, "4390": 38, "22650": 38, "5666": 38, "27epoch": 38, "391": 38, "160": 38, "094": 38, "473": 38, "288": 38, "154": 38, "405": 38, "153": 38, "951": 38, "astrocyt": 38, "2724": 38, "1184": 38, "115": 38, "439": 38, "ependym": 38, "1029": 38, "excitatori": 38, "4629": 38, "9895": 38, "microglia": 38, "475": 38, "od": 38, "immatur": 38, "809": [38, 39], "matur": 38, "190": 38, "922": 38, "pericyt": 38, "163": 38, "22647": 38, "5669": 38, "31": 38, "05epoch": 38, "cl_loss": [38, 39], "036": 38, "009": [38, 39], "val_cl_loss": [38, 39], "317": 38, "010": 38, "06": 38, "03epoch": 38, "scib_metr": [38, 39], "benchmark": [38, 39], "bioconserv": [38, 39], "biocon": 38, "nmi_ari_cluster_labels_leiden": [38, 39], "nmi_ari_cluster_labels_kmean": 38, "batcon": 38, "batchcorrect": [38, 39], "pcr_comparison": 38, "bm": [38, 39], "label_kei": [38, 39], "embedding_obsm_kei": [38, 39], "x_pca_correct": 38, "x_pca": [38, 39], "bio_conservation_metr": [38, 39], "batch_correction_metr": 38, "plot_results_t": [38, 39], "min_max_scal": [38, 39], "70": 38, "bio": 38, "conserv": 38, "isolated_label": 38, "jax": [38, 39], "_src": [38, 39], "xla_bridg": [38, 39], "nvidia": [38, 39], "mai": [38, 39], "machin": [38, 39], "jaxlib": [38, 39], "instal": [38, 39], "fall": [38, 39], "back": [38, 39], "02": [38, 39], "46": 38, "silhouette_label": 38, "94": 38, "clisi_knn": 38, "69": 38, "silhouette_batch": 38, "50": [38, 39], "93": 38, "ilisi_knn": 38, "67": 38, "kbet_per_label": 38, "35": 38, "graph_connect": 38, "80": 38, "36": 38, "atch": 38, "83": 38, "26": 38, "33": [38, 39], "plottabl": [38, 39], "tabl": [38, 39], "0x7fdb6c7edd20": 38, "model_config": 38, "run_config": 38, "global": 38, "48": 38, "75epoch": 38, "880": 38, "146": 38, "231": 38, "884": 38, "147": 38, "476": 38, "45": 38, "72epoch": 38, "012": 38, "212": 38, "722": 38, "x_unsmooth": 38, "length": 38, "doe": 38, "instead": 38, "strategi": 38, "bass": 38, "listdir": 38, "merfish_anno": 38, "anno": 38, "read_csv": 38, "index_col": 38, "batch_id": 38, "loc": 38, "60step": 38, "370": [38, 39], "799": 38, "428": 38, "011": 38, "scatter": 38, "y": 38, "tab20": 38, "5337230222364567": 38, "6226701393120998": 38, "49295132575539485": 38, "6502377274236062": 38, "6812873877486072": 38, "sce": 39, "frameon": 39, "dpi": 39, "get_umap": 39, "embed_kei": 39, "els": 39, "_umap": 39, "png": 39, "scib_benchmark": 39, "immune_all_human": 39, "cell_state_kei": 39, "final_annot": 39, "pca": 39, "n_comp": 39, "33506": 39, "8581": 39, "freytag": 39, "2677": 39, "oetjen_a": 39, "2068": 39, "oetjen_p": 39, "2612": 39, "oetjen_u": 39, "2984": 39, "sun_sample1_c": 39, "1380": 39, "sun_sample2_kc": 39, "1824": 39, "sun_sample3_tb": 39, "1922": 39, "sun_sample4_tc": 39, "1936": 39, "villani": 39, "817": 39, "26801": 39, "6705": 39, "215": 39, "732": 39, "441": 39, "246": 39, "386": 39, "758": 39, "566": 39, "753": 39, "340": 39, "cd4": 39, "8808": 39, "cd8": 39, "1746": 39, "cd10": 39, "b": 39, "165": 39, "cd14": 39, "5186": 39, "cd16": 39, "797": 39, "cd20": 39, "2298": 39, "erythrocyt": 39, "1201": 39, "erythroid": 39, "progenitor": 39, "hspc": 39, "378": 39, "megakaryocyt": 39, "216": 39, "342": 39, "dendrit": 39, "1835": 39, "2196": 39, "plasma": 39, "103": 39, "plasmacytoid": 39, "348": 39, "26798": 39, "6708": 39, "56": 39, "020": 39, "782": 39, "462": 39, "57": 39, "x_pca_uncorrect": 39, "neighbors_kei": 39, "bioc": 39, "109": 39, "85": 39, "0x7fcaac525960": 39}, "objects": {"": [[9, 0, 0, "-", "step"]], "step": [[6, 0, 0, "-", "functionality"], [10, 0, 0, "-", "integration"], [11, 0, 0, "-", "manager"], [18, 0, 0, "-", "models"], [23, 0, 0, "-", "modules"], [25, 0, 0, "-", "scmodel"], [26, 0, 0, "-", "stmodel"], [29, 0, 0, "-", "utils"]], "step.functionality": [[1, 0, 0, "-", "base"], [2, 0, 0, "-", "comps"], [5, 0, 0, "-", "cross_funcmodel"], [7, 0, 0, "-", "sc_funcmodel"], [8, 0, 0, "-", "st_funcmodel"]], "step.functionality.base": [[1, 1, 1, "", "FunctionalBase"]], "step.functionality.base.FunctionalBase": [[1, 2, 1, "", "device"], [1, 3, 1, "", "load_checkpoint"], [1, 2, 1, "", "model"], [1, 3, 1, "", "run"], [1, 2, 1, "", "split_rate"], [1, 2, 1, "", "use_earlystop"]], "step.functionality.comps": [[3, 0, 0, "-", "model_ops"], [4, 0, 0, "-", "trainer"]], "step.functionality.comps.model_ops": [[3, 1, 1, "", "ModelOps"]], "step.functionality.comps.model_ops.ModelOps": [[3, 3, 1, "", "add_embed"], [3, 3, 1, "", "embed"], [3, 3, 1, "", "generate"], [3, 3, 1, "", "get_batch_ohenc"], [3, 3, 1, "", "get_gene_modules"], [3, 3, 1, "", "get_px"], [3, 3, 1, "", "get_signatures"], [3, 3, 1, "", "impute"], [3, 3, 1, "", "loss"], [3, 3, 1, "", "loss_fn"], [3, 3, 1, "", "loss_gbatch"], [3, 2, 1, "", "model"], [3, 3, 1, "", "regress_out"], [3, 3, 1, "", "reset_model"], [3, 3, 1, "", "set_beta"], [3, 3, 1, "", "set_kl_cutoff"], [3, 3, 1, "", "set_kl_start"], [3, 3, 1, "", "show_attn_maps"]], "step.functionality.comps.trainer": [[4, 1, 1, "", "EarlyStopping"], [4, 1, 1, "", "Trainer"], [4, 4, 1, "", "category_random_split"], [4, 4, 1, "", "train_loop_formatter"]], "step.functionality.comps.trainer.Trainer": [[4, 3, 1, "", "check_early_stop"], [4, 3, 1, "", "cum_loss"], [4, 2, 1, "", "defualt_lcfg"], [4, 2, 1, "", "early_stopping"], [4, 3, 1, "", "format_loss_dict"], [4, 3, 1, "", "handle_ginput_tuple"], [4, 3, 1, "", "handle_input_tuple"], [4, 3, 1, "", "init_optimizer"], [4, 2, 1, "", "lossconfig"], [4, 2, 1, "", "lr_scheduler"], [4, 3, 1, "", "make_loaders"], [4, 3, 1, "", "mode_switch_to_train"], [4, 2, 1, "", "model"], [4, 2, 1, "", "optimizer"], [4, 3, 1, "", "set_lr_scheduler"], [4, 3, 1, "", "setup_early_stopping"], [4, 3, 1, "", "split_X"], [4, 3, 1, "", "train"], [4, 3, 1, "", "train_batch"], [4, 3, 1, "", "train_graph_batch"], [4, 3, 1, "", "train_node_sampler"], [4, 3, 1, "", "update_model_params"], [4, 3, 1, "", "validate_X"], [4, 3, 1, "", "validate_gloader"], [4, 3, 1, "", "validate_loader"]], "step.functionality.cross_funcmodel": [[5, 1, 1, "", "CrossModalityNrmls"]], "step.functionality.cross_funcmodel.CrossModalityNrmls": [[5, 2, 1, "", "_gener_graph"], [5, 2, 1, "", "_num_batches"], [5, 2, 1, "", "_rout"], [5, 3, 1, "", "add_embed_st"], [5, 3, 1, "", "deconv"], [5, 2, 1, "", "edge_clip"], [5, 3, 1, "", "from_spatial_graph"], [5, 3, 1, "", "generate_domains"], [5, 3, 1, "", "get_prop"], [5, 3, 1, "", "get_pz"], [5, 3, 1, "", "get_scores"], [5, 3, 1, "", "get_signatures"], [5, 3, 1, "", "handle_ginput_tuple"], [5, 3, 1, "", "integrate"], [5, 3, 1, "", "load_checkpoint"], [5, 2, 1, "", "max_neighs"], [5, 2, 1, "", "mixer"], [5, 2, 1, "", "need_anchor"], [5, 3, 1, "", "nnls_deconv"], [5, 3, 1, "", "reference_map"], [5, 3, 1, "", "run"], [5, 2, 1, "", "single_st"], [5, 2, 1, "", "st_decoder"], [5, 3, 1, "", "st_impute"]], "step.functionality.sc_funcmodel": [[7, 1, 1, "", "scMultiBatchNrmls"], [7, 1, 1, "", "scSingleBatch"]], "step.functionality.sc_funcmodel.scMultiBatchNrmls": [[7, 2, 1, "", "_factor"], [7, 3, 1, "", "clsf"], [7, 3, 1, "", "clsf_"], [7, 3, 1, "", "embed"], [7, 3, 1, "", "get_anchors"], [7, 3, 1, "", "handle_input_tuple"], [7, 3, 1, "", "impute"], [7, 3, 1, "", "loss"], [7, 2, 1, "", "model"], [7, 3, 1, "", "refine"], [7, 3, 1, "", "reset_model"], [7, 3, 1, "", "run"], [7, 3, 1, "", "train"]], "step.functionality.sc_funcmodel.scSingleBatch": [[7, 3, 1, "", "handle_input_tuple"], [7, 2, 1, "", "model"]], "step.functionality.st_funcmodel": [[8, 1, 1, "", "stSmoother"]], "step.functionality.st_funcmodel.stSmoother": [[8, 2, 1, "", "_factor"], [8, 2, 1, "", "_from_scmodel"], [8, 2, 1, "", "_gener_graph"], [8, 2, 1, "", "_num_batches"], [8, 3, 1, "", "embed"], [8, 3, 1, "", "from_spatial_graph"], [8, 3, 1, "", "gembed"], [8, 3, 1, "", "handle_ginput_tuple"], [8, 3, 1, "", "handle_input_tuple"], [8, 3, 1, "", "loss_gbatch"], [8, 2, 1, "", "model"], [8, 3, 1, "", "reset_model"], [8, 3, 1, "", "run"], [8, 2, 1, "", "use_earlystop"]], "step.integration": [[10, 1, 1, "", "crossModel"]], "step.integration.crossModel": [[10, 2, 1, "", "_functional"], [10, 5, 1, "id0", "adata"], [10, 3, 1, "", "cluster"], [10, 2, 1, "", "dataset"], [10, 3, 1, "", "load"], [10, 5, 1, "", "model"], [10, 3, 1, "", "save"], [10, 3, 1, "", "spatial_plot"], [10, 5, 1, "id1", "st_adata"], [10, 3, 1, "", "sub_cluster"], [10, 3, 1, "", "summarize_domain"], [10, 3, 1, "", "summarize_single_domain"]], "step.manager": [[11, 1, 1, "", "CustomFormatter"], [11, 6, 1, "", "ch"], [11, 6, 1, "", "formatter"], [11, 6, 1, "", "logger"], [12, 0, 0, "-", "save"], [11, 4, 1, "", "set_verbosity"]], "step.manager.CustomFormatter": [[11, 3, 1, "", "format"]], "step.manager.save": [[12, 1, 1, "", "Saver"]], "step.manager.save.Saver": [[12, 2, 1, "", "adata"], [12, 2, 1, "", "dataset"], [12, 2, 1, "", "funcmodel"], [12, 3, 1, "", "get_instance"], [12, 3, 1, "", "save"]], "step.models": [[13, 0, 0, "-", "clust"], [14, 0, 0, "-", "deconv"], [15, 0, 0, "-", "distributions"], [16, 0, 0, "-", "extension"], [17, 0, 0, "-", "geneformer"], [19, 0, 0, "-", "knn_map"], [20, 0, 0, "-", "nnls"]], "step.models.clust": [[13, 1, 1, "", "ClusterGeneric"], [13, 4, 1, "", "kmeans"], [13, 4, 1, "", "mclust_R"]], "step.models.clust.ClusterGeneric": [[13, 2, 1, "", "method"], [13, 2, 1, "", "seed"]], "step.models.deconv": [[14, 1, 1, "", "Mixer"], [14, 1, 1, "", "TopNAttention"]], "step.models.deconv.Mixer": [[14, 2, 1, "", "T"], [14, 2, 1, "", "alpha"], [14, 2, 1, "", "anchors"], [14, 5, 1, "", "anchors_"], [14, 2, 1, "", "domain_wise"], [14, 3, 1, "", "forward"], [14, 2, 1, "", "g"], [14, 3, 1, "", "get_prop"], [14, 3, 1, "", "get_scores"], [14, 2, 1, "", "hard_anchors"], [14, 2, 1, "", "hidden_dim"], [14, 3, 1, "", "inf_pz"], [14, 3, 1, "", "mask_prop"], [14, 2, 1, "", "max_ct_per_spot"], [14, 2, 1, "", "n_layers"], [14, 2, 1, "", "n_spots"], [14, 3, 1, "", "p_hat"], [14, 3, 1, "", "params"], [14, 3, 1, "", "phat_params"], [14, 2, 1, "", "rate"], [14, 3, 1, "", "sc_consistency"], [14, 2, 1, "", "signatures"], [14, 2, 1, "", "smoother"], [14, 2, 1, "", "solver"], [14, 3, 1, "", "ts_forward"], [14, 2, 1, "", "use_smoother"]], "step.models.deconv.TopNAttention": [[14, 2, 1, "", "T"], [14, 2, 1, "", "act"], [14, 2, 1, "", "embed_dim"], [14, 3, 1, "", "forward"], [14, 2, 1, "", "kv"], [14, 2, 1, "", "num_heads"], [14, 2, 1, "", "out"], [14, 2, 1, "", "q"], [14, 2, 1, "", "top_n"]], "step.models.distributions": [[15, 1, 1, "", "NegativeBinomial"], [15, 1, 1, "", "ZeroInflatedNegativeBinomial"], [15, 4, 1, "", "log_mixture_nb"], [15, 4, 1, "", "log_nb_positive"], [15, 4, 1, "", "log_zinb_positive"]], "step.models.distributions.NegativeBinomial": [[15, 2, 1, "", "arg_constraints"], [15, 3, 1, "", "log_prob"], [15, 5, 1, "", "mean"], [15, 3, 1, "", "pearson_residuals"], [15, 3, 1, "", "rsample"], [15, 3, 1, "", "sample"], [15, 2, 1, "", "support"], [15, 5, 1, "", "variance"]], "step.models.distributions.ZeroInflatedNegativeBinomial": [[15, 2, 1, "", "arg_constraints"], [15, 3, 1, "", "log_prob"], [15, 5, 1, "", "mean"], [15, 3, 1, "", "rsample"], [15, 3, 1, "", "sample"], [15, 2, 1, "", "support"], [15, 5, 1, "", "variance"], [15, 3, 1, "", "zi_logits"], [15, 3, 1, "", "zi_probs"]], "step.models.extension": [[16, 1, 1, "", "BatchAwareLayerNorm"], [16, 1, 1, "", "BatchAwareScale"], [16, 1, 1, "", "NrmlsBC"]], "step.models.extension.BatchAwareLayerNorm": [[16, 2, 1, "", "act"], [16, 3, 1, "", "forward"], [16, 2, 1, "", "layernorm"], [16, 2, 1, "", "mean"], [16, 2, 1, "", "scale"]], "step.models.extension.BatchAwareScale": [[16, 2, 1, "", "act"], [16, 3, 1, "", "forward"], [16, 2, 1, "", "net"]], "step.models.extension.NrmlsBC": [[16, 2, 1, "", "args"], [16, 2, 1, "", "batch_emb_dim"], [16, 2, 1, "", "batch_embedding"], [16, 2, 1, "", "batch_readout"], [16, 3, 1, "", "copy"], [16, 3, 1, "", "copy_dec"], [16, 3, 1, "", "decode"], [16, 3, 1, "", "decode_"], [16, 3, 1, "", "decode_skip"], [16, 3, 1, "", "decode_ts"], [16, 3, 1, "", "encode"], [16, 3, 1, "", "encode_ts"], [16, 3, 1, "", "forward"], [16, 3, 1, "", "init_anchor"], [16, 2, 1, "", "moduler"], [16, 5, 1, "", "non_decoder_param"], [16, 2, 1, "", "num_batches"], [16, 3, 1, "", "readout_"], [16, 3, 1, "", "readout_batch"], [16, 2, 1, "", "smoother"]], "step.models.geneformer": [[17, 1, 1, "", "GeneModuler"], [17, 1, 1, "", "Geneformer"], [17, 1, 1, "", "Linear2D"], [17, 1, 1, "", "Readout"], [17, 6, 1, "", "drop_edge"]], "step.models.geneformer.GeneModuler": [[17, 3, 1, "", "demodule"], [17, 2, 1, "", "extractor"], [17, 3, 1, "", "forward"], [17, 2, 1, "", "hidden_dim"], [17, 2, 1, "", "input_dim"], [17, 2, 1, "", "layernorm"], [17, 2, 1, "", "n_modules"], [17, 3, 1, "", "random_permute"]], "step.models.geneformer.Geneformer": [[17, 2, 1, "", "_smooth"], [17, 2, 1, "", "args"], [17, 2, 1, "", "cls_token"], [17, 3, 1, "", "copy"], [17, 3, 1, "", "decode"], [17, 3, 1, "", "decode_ts"], [17, 2, 1, "", "decoder"], [17, 2, 1, "", "decoder_type"], [17, 3, 1, "", "encode"], [17, 3, 1, "", "encode_ts"], [17, 2, 1, "", "expand"], [17, 3, 1, "", "forward"], [17, 2, 1, "", "gargs"], [17, 3, 1, "", "get_px_r"], [17, 2, 1, "", "hidden_dim"], [17, 3, 1, "", "init_smoother"], [17, 3, 1, "", "init_smoother_with_builtin"], [17, 2, 1, "", "input_dim"], [17, 3, 1, "", "local_smooth"], [17, 2, 1, "", "module"], [17, 2, 1, "", "module_dim"], [17, 2, 1, "", "moduler"], [17, 2, 1, "", "n_modules"], [17, 2, 1, "", "px_r"], [17, 2, 1, "", "readout"], [17, 3, 1, "", "readout_"], [17, 2, 1, "", "smoother"], [17, 2, 1, "", "smoother_type"]], "step.models.geneformer.Linear2D": [[17, 3, 1, "", "forward"]], "step.models.geneformer.Readout": [[17, 3, 1, "", "clear"], [17, 3, 1, "", "forward"], [17, 3, 1, "", "kl_loss"], [17, 2, 1, "", "logvar"], [17, 2, 1, "", "mean"], [17, 2, 1, "", "net"], [17, 2, 1, "", "out"], [17, 2, 1, "", "variational"]], "step.models.knn_map": [[19, 4, 1, "", "knn_random_coords"]], "step.models.nnls": [[20, 4, 1, "", "nnls_deconv"]], "step.modules": [[21, 0, 0, "-", "decoder"], [22, 0, 0, "-", "gnn"], [24, 0, 0, "-", "transformer"]], "step.modules.decoder": [[21, 1, 1, "", "Exp"], [21, 1, 1, "", "ProbDecoder"]], "step.modules.decoder.Exp": [[21, 3, 1, "", "forward"]], "step.modules.decoder.ProbDecoder": [[21, 2, 1, "", "args"], [21, 3, 1, "", "copy"], [21, 3, 1, "", "dropout_"], [21, 3, 1, "", "ffn_"], [21, 3, 1, "", "forward"]], "step.modules.gnn": [[22, 1, 1, "", "GAT"], [22, 1, 1, "", "GCN"]], "step.modules.gnn.GAT": [[22, 3, 1, "", "forward"]], "step.modules.gnn.GCN": [[22, 3, 1, "", "forward"], [22, 2, 1, "", "h_feats"], [22, 2, 1, "", "in_feats"], [22, 2, 1, "", "n_layers"], [22, 2, 1, "", "with_edge"]], "step.modules.transformer": [[24, 1, 1, "", "Attention"], [24, 1, 1, "", "FeedForward"], [24, 1, 1, "", "PreNorm"], [24, 1, 1, "", "Transformer"], [24, 4, 1, "", "exists"], [24, 4, 1, "", "pair"], [24, 4, 1, "", "softmax_one"]], "step.modules.transformer.Attention": [[24, 3, 1, "", "forward"]], "step.modules.transformer.FeedForward": [[24, 3, 1, "", "forward"]], "step.modules.transformer.PreNorm": [[24, 3, 1, "", "forward"]], "step.modules.transformer.Transformer": [[24, 3, 1, "", "forward"]], "step.scmodel": [[25, 1, 1, "", "scModel"]], "step.scmodel.scModel": [[25, 2, 1, "", "_functional"], [25, 5, 1, "id0", "adata"], [25, 2, 1, "", "dataset"], [25, 3, 1, "", "load"], [25, 3, 1, "", "load_checkpoint"], [25, 5, 1, "", "model"], [25, 3, 1, "", "save"]], "step.stmodel": [[26, 1, 1, "", "stModel"]], "step.stmodel.stModel": [[26, 2, 1, "", "_functional"], [26, 5, 1, "id0", "adata"], [26, 3, 1, "", "cluster"], [26, 2, 1, "", "dataset"], [26, 3, 1, "", "load"], [26, 5, 1, "", "model"], [26, 3, 1, "", "save"], [26, 3, 1, "", "spatial_plot"], [26, 3, 1, "", "sub_cluster"], [26, 3, 1, "", "summarize_domain"], [26, 3, 1, "", "summarize_single_domain"]], "step.utils": [[27, 0, 0, "-", "dataset"], [28, 0, 0, "-", "gbolt"], [30, 0, 0, "-", "metrics"], [31, 0, 0, "-", "misc"], [32, 0, 0, "-", "plotting"], [33, 0, 0, "-", "synthetics"]], "step.utils.dataset": [[27, 1, 1, "", "BaseDataset"], [27, 1, 1, "", "CrossDataset"], [27, 1, 1, "", "MaskedDataset"], [27, 6, 1, "", "PROCESS_FIELDS"], [27, 6, 1, "", "READ_FIELDS"], [27, 6, 1, "", "RECIEVE_FIELDS"], [27, 1, 1, "", "ScDataset"], [27, 1, 1, "", "ScMode"], [27, 1, 1, "", "StDataset"], [27, 1, 1, "", "StMode"]], "step.utils.dataset.BaseDataset": [[27, 2, 1, "", "adata"], [27, 5, 1, "", "batch_codes"], [27, 2, 1, "", "batch_key"], [27, 5, 1, "", "batch_names"], [27, 5, 1, "", "class_codes"], [27, 2, 1, "", "filtered"], [27, 2, 1, "", "geneset"], [27, 3, 1, "", "get"], [27, 2, 1, "", "hvg_method"], [27, 2, 1, "", "is_human"], [27, 2, 1, "", "layer_key"], [27, 2, 1, "", "log_transformed"], [27, 2, 1, "", "logarithm_first"], [27, 2, 1, "", "mode"], [27, 5, 1, "", "n_genes"], [27, 2, 1, "", "n_top_genes"], [27, 2, 1, "", "num_batches"], [27, 2, 1, "", "num_classes"], [27, 3, 1, "", "process"], [27, 2, 1, "id8", "process_fields"], [27, 3, 1, "", "read"], [27, 2, 1, "id7", "read_fields"], [27, 3, 1, "id10", "read_folder"], [27, 2, 1, "id9", "recieve_fields"], [27, 3, 1, "", "subset"], [27, 3, 1, "", "switch_layer"]], "step.utils.dataset.CrossDataset": [[27, 2, 1, "", "_integrated"], [27, 2, 1, "", "batch_key"], [27, 2, 1, "", "class_key"], [27, 2, 1, "", "coord_keys"], [27, 2, 1, "", "mode"], [27, 2, 1, "", "num_classes"], [27, 5, 1, "", "num_st_batches"], [27, 2, 1, "id17", "process_fields"], [27, 3, 1, "", "read"], [27, 2, 1, "id18", "recieve_fields"], [27, 2, 1, "", "rep"], [27, 3, 1, "", "set_mode"], [27, 3, 1, "", "set_rep"], [27, 2, 1, "", "st_adata"], [27, 5, 1, "", "st_batch_codes"], [27, 5, 1, "", "st_sample_list"], [27, 2, 1, "", "st_sample_names"], [27, 3, 1, "", "subset_st"]], "step.utils.dataset.MaskedDataset": [[27, 2, 1, "", "_indices"], [27, 2, 1, "", "_mask"], [27, 5, 1, "", "adata"], [27, 5, 1, "", "masked_num_batches"], [27, 5, 1, "", "masked_num_classes"], [27, 5, 1, "", "mode"], [27, 2, 1, "", "original_dataset"], [27, 3, 1, "", "set_mode"], [27, 3, 1, "", "subset"]], "step.utils.dataset.ScDataset": [[27, 2, 1, "", "class_key"], [27, 2, 1, "", "mode"], [27, 2, 1, "", "num_classes"], [27, 2, 1, "id13", "process_fields"], [27, 2, 1, "id11", "read_fields"], [27, 2, 1, "id14", "read_folder"], [27, 2, 1, "id12", "recieve_fields"], [27, 3, 1, "", "set_mode"]], "step.utils.dataset.ScMode": [[27, 2, 1, "id1", "multi_batches"], [27, 2, 1, "id2", "multi_batches_with_ct"], [27, 2, 1, "id0", "single_batch"]], "step.utils.dataset.StDataset": [[27, 2, 1, "", "coord_keys"], [27, 2, 1, "", "domains"], [27, 2, 1, "", "mode"], [27, 2, 1, "", "process_fields"], [27, 2, 1, "id16", "read_fields"], [27, 2, 1, "id15", "read_folder"], [27, 2, 1, "", "recieve_fields"], [27, 2, 1, "", "rep"], [27, 3, 1, "", "set_domains"], [27, 3, 1, "", "set_mode"], [27, 3, 1, "", "set_prior_coef"]], "step.utils.dataset.StMode": [[27, 2, 1, "id4", "multi_batches"], [27, 2, 1, "id3", "single_batch"], [27, 2, 1, "id6", "with_domains"], [27, 2, 1, "id5", "with_rep"]], "step.utils.gbolt": [[28, 1, 1, "", "MultiGraphsAllNodesSampler"]], "step.utils.gbolt.MultiGraphsAllNodesSampler": [[28, 2, 1, "", "n_graphs"], [28, 3, 1, "", "node_sampler"]], "step.utils.metrics": [[30, 4, 1, "", "geary_c"], [30, 4, 1, "", "moran_i"]], "step.utils.misc": [[31, 4, 1, "", "aver_items_by_ct"], [31, 4, 1, "", "compute_selfattention"], [31, 4, 1, "", "extract_selfattention_maps"], [31, 4, 1, "", "generate_adj"], [31, 4, 1, "", "get_de_genes"], [31, 4, 1, "", "read_visium_hd"], [31, 4, 1, "", "set_seed"]], "step.utils.plotting": [[32, 4, 1, "", "plot_domain_summary"], [32, 4, 1, "", "plot_domain_summary_single_ct"], [32, 4, 1, "", "plot_posterior_mu_vs_data"], [32, 4, 1, "", "plot_single_domain_summary"], [32, 4, 1, "", "plot_spatial_pie_charts"], [32, 4, 1, "", "plot_trajectory"], [32, 4, 1, "", "plot_trajectory_curve"], [32, 4, 1, "", "set_cmap"], [32, 4, 1, "", "spatial_plot"]], "step.utils.synthetics": [[34, 0, 0, "-", "pseudo_st"]], "step.utils.synthetics.pseudo_st": [[34, 1, 1, "", "PseudoST"]], "step.utils.synthetics.pseudo_st.PseudoST": [[34, 2, 1, "", "adata_sc"], [34, 2, 1, "", "adata_st"], [34, 2, 1, "", "batch_key"], [34, 2, 1, "", "cell_type_key"], [34, 2, 1, "", "coords_key"], [34, 2, 1, "", "downsapmle_size"], [34, 2, 1, "", "info_key"], [34, 2, 1, "", "k_hop"], [34, 2, 1, "", "layer_key"], [34, 3, 1, "", "save"], [34, 3, 1, "", "simulate"], [34, 2, 1, "", "sub_type_key"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:function", "5": "py:property", "6": "py:data"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "function", "Python function"], "5": ["py", "property", "Python property"], "6": ["py", "data", "Python data"]}, "titleterms": {"tutori": 0, "api": 0, "refer": 0, "step": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39], "function": [1, 2, 3, 4, 5, 6, 7, 8, 11, 13, 15, 19, 20, 24, 30, 31, 32], "base": 1, "modul": [1, 3, 4, 5, 7, 8, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 34], "content": [1, 3, 4, 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 24, 25, 26, 27, 28, 30, 31, 32, 34, 35], "class": [1, 3, 4, 5, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 21, 22, 24, 25, 26, 27, 28, 34], "comp": [2, 3, 4], "submodul": [2, 6, 9, 11, 18, 23, 29, 33], "model_op": 3, "trainer": 4, "cross_funcmodel": 5, "subpackag": [6, 9, 29], "sc_funcmodel": 7, "st_funcmodel": 8, "integr": [10, 37, 39], "manag": [11, 12], "packag": [11, 37], "attribut": [11, 17, 27], "save": 12, "model": [13, 14, 15, 16, 17, 18, 19, 20, 38], "clust": 13, "deconv": 14, "distribut": 15, "extens": 16, "geneform": 17, "knn_map": 19, "nnl": 20, "decod": 21, "gnn": 22, "transform": 24, "scmodel": 25, "stmodel": 26, "util": [27, 28, 29, 30, 31, 32, 33, 34], "dataset": [27, 39], "gbolt": 28, "metric": [30, 38], "misc": 31, "plot": [32, 36], "synthet": [33, 34], "pseudo_st": 34, "welcom": 35, "": 35, "document": 35, "spatial": [36, 37, 38], "domain": [36, 37, 38], "identif": [36, 38], "10x": [36, 37], "visium": [36, 37], "dlfpc": 36, "data": [36, 37, 38], "151673": 36, "singl": 36, "section": 36, "without": 36, "us": 36, "variat": 36, "151676": 36, "togeth": 36, "ari": 36, "na": 36, "spot": 36, "perform": 37, "analysi": 37, "scrna": 37, "seq": [37, 38], "human": [37, 39], "lymph": 37, "node": 37, "load": [37, 38], "initi": 37, "instanc": 37, "co": 37, "embed": [37, 38, 39], "two": 37, "modal": 37, "get": 37, "check": 37, "result": 37, "zonat": 37, "after": 37, "cell": [37, 38, 39], "type": 37, "deconvolut": 37, "obtain": [37, 38], "visual": [37, 38], "infer": 37, "composit": 37, "de": 37, "gene": [37, 39], "anlaysi": 37, "summar": 37, "averag": 37, "proport": 37, "select": 37, "each": 37, "reveal": 38, "multipl": 38, "level": 38, "biolog": 38, "heterogen": 38, "mous": 38, "hypothalamu": 38, "merfish": 38, "state": 38, "setup": 38, "object": 38, "smooth": 38, "e2": 38, "mode": 38, "direct": 38, "config": 38, "run": 38, "add": 38, "annot": 38, "zone": 38, "set": 38, "up": 38, "gener": [38, 39], "cluster": 38, "them": 38, "evalu": 38, "compar": 38, "immun": 39, "batch": 39, "correct": 39, "express": 39}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Tutorials": [[0, "tutorials"]], "API Reference": [[0, "api-reference"]], "step.functionality.base": [[1, "module-step.functionality.base"]], "Module Contents": [[1, "module-contents"], [3, "module-contents"], [4, "module-contents"], [5, "module-contents"], [7, "module-contents"], [8, "module-contents"], [10, "module-contents"], [12, "module-contents"], [13, "module-contents"], [14, "module-contents"], [15, "module-contents"], [16, "module-contents"], [17, "module-contents"], [19, "module-contents"], [20, "module-contents"], [21, "module-contents"], [22, "module-contents"], [24, "module-contents"], [25, "module-contents"], [26, "module-contents"], [27, "module-contents"], [28, "module-contents"], [30, "module-contents"], [31, "module-contents"], [32, "module-contents"], [34, "module-contents"]], "Classes": [[1, "classes"], [3, "classes"], [4, "classes"], [5, "classes"], [7, "classes"], [8, "classes"], [10, "classes"], [11, "classes"], [12, "classes"], [13, "classes"], [14, "classes"], [15, "classes"], [16, "classes"], [17, "classes"], [21, "classes"], [22, "classes"], [24, "classes"], [25, "classes"], [26, "classes"], [27, "classes"], [28, "classes"], [34, "classes"]], "step.functionality.comps": [[2, "module-step.functionality.comps"]], "Submodules": [[2, "submodules"], [6, "submodules"], [9, "submodules"], [11, "submodules"], [18, "submodules"], [23, "submodules"], [29, "submodules"], [33, "submodules"]], "step.functionality.comps.model_ops": [[3, "module-step.functionality.comps.model_ops"]], "step.functionality.comps.trainer": [[4, "module-step.functionality.comps.trainer"]], "Functions": [[4, "functions"], [11, "functions"], [13, "functions"], [15, "functions"], [19, "functions"], [20, "functions"], [24, "functions"], [30, "functions"], [31, "functions"], [32, "functions"]], "step.functionality.cross_funcmodel": [[5, "module-step.functionality.cross_funcmodel"]], "step.functionality": [[6, "module-step.functionality"]], "Subpackages": [[6, "subpackages"], [9, "subpackages"], [29, "subpackages"]], "step.functionality.sc_funcmodel": [[7, "module-step.functionality.sc_funcmodel"]], "step.functionality.st_funcmodel": [[8, "module-step.functionality.st_funcmodel"]], "step": [[9, "module-step"]], "step.integration": [[10, "module-step.integration"]], "step.manager": [[11, "module-step.manager"]], "Package Contents": [[11, "package-contents"]], "Attributes": [[11, "attributes"], [17, "attributes"], [27, "attributes"]], "step.manager.save": [[12, "module-step.manager.save"]], "step.models.clust": [[13, "module-step.models.clust"]], "step.models.deconv": [[14, "module-step.models.deconv"]], "step.models.distributions": [[15, "module-step.models.distributions"]], "step.models.extension": [[16, "module-step.models.extension"]], "step.models.geneformer": [[17, "module-step.models.geneformer"]], "step.models": [[18, "module-step.models"]], "step.models.knn_map": [[19, "module-step.models.knn_map"]], "step.models.nnls": [[20, "module-step.models.nnls"]], "step.modules.decoder": [[21, "module-step.modules.decoder"]], "step.modules.gnn": [[22, "module-step.modules.gnn"]], "step.modules": [[23, "module-step.modules"]], "step.modules.transformer": [[24, "module-step.modules.transformer"]], "step.scmodel": [[25, "module-step.scmodel"]], "step.stmodel": [[26, "module-step.stmodel"]], "step.utils.dataset": [[27, "module-step.utils.dataset"]], "step.utils.gbolt": [[28, "module-step.utils.gbolt"]], "step.utils": [[29, "module-step.utils"]], "step.utils.metrics": [[30, "module-step.utils.metrics"]], "step.utils.misc": [[31, "module-step.utils.misc"]], "step.utils.plotting": [[32, "module-step.utils.plotting"]], "step.utils.synthetics": [[33, "module-step.utils.synthetics"]], "step.utils.synthetics.pseudo_st": [[34, "module-step.utils.synthetics.pseudo_st"]], "Welcome to STEP\u2019s documentation!": [[35, "welcome-to-step-s-documentation"]], "Contents:": [[35, null]], "Spatial domain identification on 10x Visium DLFPC data": [[36, "Spatial-domain-identification-on-10x-Visium-DLFPC-data"]], "151673 single section without using variational": [[36, "151673-single-section-without-using-variational"]], "151673 single section with using variational": [[36, "151673-single-section-with-using-variational"]], "151673 to 151676 together": [[36, "151673-to-151676-together"]], "Spatial plots and ARIs without NA spots": [[36, "Spatial-plots-and-ARIs-without-NA-spots"]], "Performing integrative analysis on scRNA-seq data and 10x Visium data of Human Lymph Node with STEP": [[37, "Performing-integrative-analysis-on-scRNA-seq-data-and-10x-Visium-data-of-Human-Lymph-Node-with-STEP"]], "Loading packages": [[37, "Loading-packages"]], "Load data": [[37, "Load-data"]], "Initialize the STEP instance": [[37, "Initialize-the-STEP-instance"]], "Co-embedding two modalities": [[37, "Co-embedding-two-modalities"]], "Get and check the co-embedding results": [[37, "Get-and-check-the-co-embedding-results"]], "Zonation after integration": [[37, "Zonation-after-integration"]], "Cell-type deconvolution with obtained embedding": [[37, "Cell-type-deconvolution-with-obtained-embedding"]], "Visualize the inferred cell-type composition": [[37, "Visualize-the-inferred-cell-type-composition"]], "Perform spatially DE genes anlaysis": [[37, "Perform-spatially-DE-genes-anlaysis"]], "Summarize the average proportion of selected cell-types in each domain": [[37, "Summarize-the-average-proportion-of-selected-cell-types-in-each-domain"]], "Reveal multiple level of biological heterogeneities in Mouse Hypothalamus by MERFISH-seq": [[38, "Reveal-multiple-level-of-biological-heterogeneities-in-Mouse-Hypothalamus-by-MERFISH-seq"]], "Cell state level heterogeneity": [[38, "Cell-state-level-heterogeneity"]], "Setup STEP object": [[38, "Setup-STEP-object"]], "Spatial domain level heterogeneity by spatially smoothing the embedding in cell state level": [[38, "Spatial-domain-level-heterogeneity-by-spatially-smoothing-the-embedding-in-cell-state-level"]], "E2E mode for direct spatial domain identification": [[38, "E2E-mode-for-direct-spatial-domain-identification"]], "Model config & running config": [[38, "Model-config-&-running-config"]], "Load data and add annotations of zones": [[38, "Load-data-and-add-annotations-of-zones"]], "Set up STEP object": [[38, "Set-up-STEP-object"]], "Generate spatially smoothed embeddings and cluster them to obtain spatial domains": [[38, "Generate-spatially-smoothed-embeddings-and-cluster-them-to-obtain-spatial-domains"]], "Visualization": [[38, "Visualization"]], "Metrics for evaluation of the obtained spatial domains compared to the annotations": [[38, "Metrics-for-evaluation-of-the-obtained-spatial-domains-compared-to-the-annotations"]], "Integrate Human Immune Cell datasets with STEP and generate batch-corrected embeddings and gene expressions.": [[39, "Integrate-Human-Immune-Cell-datasets-with-STEP-and-generate-batch-corrected-embeddings-and-gene-expressions."]]}, "indexentries": {"functionalbase (class in step.functionality.base)": [[1, "step.functionality.base.FunctionalBase"]], "device (functionalbase attribute)": [[1, "step.functionality.base.FunctionalBase.device"]], "load_checkpoint() (functionalbase method)": [[1, "step.functionality.base.FunctionalBase.load_checkpoint"]], "model (functionalbase attribute)": [[1, "step.functionality.base.FunctionalBase.model"]], "module": [[1, "module-step.functionality.base"], [2, "module-step.functionality.comps"], [3, "module-step.functionality.comps.model_ops"], [4, "module-step.functionality.comps.trainer"], [5, "module-step.functionality.cross_funcmodel"], [6, "module-step.functionality"], [7, "module-step.functionality.sc_funcmodel"], [8, "module-step.functionality.st_funcmodel"], [9, "module-step"], [10, "module-step.integration"], [11, "module-step.manager"], [12, "module-step.manager.save"], [13, "module-step.models.clust"], [14, "module-step.models.deconv"], [15, "module-step.models.distributions"], [16, "module-step.models.extension"], [17, "module-step.models.geneformer"], [18, "module-step.models"], [19, "module-step.models.knn_map"], [20, "module-step.models.nnls"], [21, "module-step.modules.decoder"], [22, "module-step.modules.gnn"], [23, "module-step.modules"], [24, "module-step.modules.transformer"], [25, "module-step.scmodel"], [26, "module-step.stmodel"], [27, "module-step.utils.dataset"], [28, "module-step.utils.gbolt"], [29, "module-step.utils"], [30, "module-step.utils.metrics"], [31, "module-step.utils.misc"], [32, "module-step.utils.plotting"], [33, "module-step.utils.synthetics"], [34, "module-step.utils.synthetics.pseudo_st"]], "run() (functionalbase method)": [[1, "step.functionality.base.FunctionalBase.run"]], "split_rate (functionalbase attribute)": [[1, "step.functionality.base.FunctionalBase.split_rate"]], "step.functionality.base": [[1, "module-step.functionality.base"]], "use_earlystop (functionalbase attribute)": [[1, "step.functionality.base.FunctionalBase.use_earlystop"]], "step.functionality.comps": [[2, "module-step.functionality.comps"]], "modelops (class in step.functionality.comps.model_ops)": [[3, "step.functionality.comps.model_ops.ModelOps"]], "add_embed() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.add_embed"]], "embed() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.embed"]], "generate() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.generate"]], "get_batch_ohenc() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.get_batch_ohenc"]], "get_gene_modules() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.get_gene_modules"]], "get_px() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.get_px"]], "get_signatures() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.get_signatures"]], "impute() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.impute"]], "loss() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.loss"]], "loss_fn() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.loss_fn"]], "loss_gbatch() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.loss_gbatch"]], "model (modelops attribute)": [[3, "step.functionality.comps.model_ops.ModelOps.model"]], "regress_out() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.regress_out"]], "reset_model() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.reset_model"]], "set_beta() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.set_beta"]], "set_kl_cutoff() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.set_kl_cutoff"]], "set_kl_start() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.set_kl_start"]], "show_attn_maps() (modelops method)": [[3, "step.functionality.comps.model_ops.ModelOps.show_attn_maps"]], "step.functionality.comps.model_ops": [[3, "module-step.functionality.comps.model_ops"]], "earlystopping (class in step.functionality.comps.trainer)": [[4, "step.functionality.comps.trainer.EarlyStopping"]], "trainer (class in step.functionality.comps.trainer)": [[4, "step.functionality.comps.trainer.Trainer"]], "category_random_split() (in module step.functionality.comps.trainer)": [[4, "step.functionality.comps.trainer.category_random_split"]], "check_early_stop() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.check_early_stop"]], "cum_loss() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.cum_loss"]], "defualt_lcfg (trainer attribute)": [[4, "step.functionality.comps.trainer.Trainer.defualt_lcfg"]], "early_stopping (trainer attribute)": [[4, "step.functionality.comps.trainer.Trainer.early_stopping"]], "format_loss_dict() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.format_loss_dict"]], "handle_ginput_tuple() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.handle_ginput_tuple"]], "handle_input_tuple() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.handle_input_tuple"]], "init_optimizer() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.init_optimizer"]], "lossconfig (trainer attribute)": [[4, "step.functionality.comps.trainer.Trainer.lossconfig"]], "lr_scheduler (trainer attribute)": [[4, "step.functionality.comps.trainer.Trainer.lr_scheduler"]], "make_loaders() (trainer static method)": [[4, "step.functionality.comps.trainer.Trainer.make_loaders"]], "mode_switch_to_train() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.mode_switch_to_train"]], "model (trainer attribute)": [[4, "step.functionality.comps.trainer.Trainer.model"]], "optimizer (trainer attribute)": [[4, "step.functionality.comps.trainer.Trainer.optimizer"]], "set_lr_scheduler() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.set_lr_scheduler"]], "setup_early_stopping() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.setup_early_stopping"]], "split_x() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.split_X"]], "step.functionality.comps.trainer": [[4, "module-step.functionality.comps.trainer"]], "train() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.train"]], "train_batch() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.train_batch"]], "train_graph_batch() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.train_graph_batch"]], "train_loop_formatter() (in module step.functionality.comps.trainer)": [[4, "step.functionality.comps.trainer.train_loop_formatter"]], "train_node_sampler() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.train_node_sampler"]], "update_model_params() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.update_model_params"]], "validate_x() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.validate_X"]], "validate_gloader() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.validate_gloader"]], "validate_loader() (trainer method)": [[4, "step.functionality.comps.trainer.Trainer.validate_loader"]], "crossmodalitynrmls (class in step.functionality.cross_funcmodel)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls"]], "_gener_graph (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls._gener_graph"]], "_num_batches (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls._num_batches"]], "_rout (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls._rout"]], "add_embed_st() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.add_embed_st"]], "deconv() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.deconv"]], "edge_clip (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.edge_clip"]], "from_spatial_graph() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.from_spatial_graph"]], "generate_domains() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.generate_domains"]], "get_prop() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.get_prop"]], "get_pz() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.get_pz"]], "get_scores() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.get_scores"]], "get_signatures() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.get_signatures"]], "handle_ginput_tuple() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.handle_ginput_tuple"]], "integrate() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.integrate"]], "load_checkpoint() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.load_checkpoint"]], "max_neighs (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.max_neighs"]], "mixer (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.mixer"]], "need_anchor (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.need_anchor"]], "nnls_deconv() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.nnls_deconv"]], "reference_map() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.reference_map"]], "run() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.run"]], "single_st (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.single_st"]], "st_decoder (crossmodalitynrmls attribute)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.st_decoder"]], "st_impute() (crossmodalitynrmls method)": [[5, "step.functionality.cross_funcmodel.CrossModalityNrmls.st_impute"]], "step.functionality.cross_funcmodel": [[5, "module-step.functionality.cross_funcmodel"]], "step.functionality": [[6, "module-step.functionality"]], "_factor (scmultibatchnrmls attribute)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls._factor"]], "clsf() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf"]], "clsf_() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf_"]], "embed() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.embed"]], "get_anchors() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.get_anchors"]], "handle_input_tuple() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.handle_input_tuple"]], "handle_input_tuple() (scsinglebatch method)": [[7, "step.functionality.sc_funcmodel.scSingleBatch.handle_input_tuple"]], "impute() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.impute"]], "loss() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.loss"]], "model (scmultibatchnrmls attribute)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.model"]], "model (scsinglebatch attribute)": [[7, "step.functionality.sc_funcmodel.scSingleBatch.model"]], "refine() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.refine"]], "reset_model() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.reset_model"]], "run() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.run"]], "scmultibatchnrmls (class in step.functionality.sc_funcmodel)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls"]], "scsinglebatch (class in step.functionality.sc_funcmodel)": [[7, "step.functionality.sc_funcmodel.scSingleBatch"]], "step.functionality.sc_funcmodel": [[7, "module-step.functionality.sc_funcmodel"]], "train() (scmultibatchnrmls method)": [[7, "step.functionality.sc_funcmodel.scMultiBatchNrmls.train"]], "_factor (stsmoother attribute)": [[8, "step.functionality.st_funcmodel.stSmoother._factor"]], "_from_scmodel (stsmoother attribute)": [[8, "step.functionality.st_funcmodel.stSmoother._from_scmodel"]], "_gener_graph (stsmoother attribute)": [[8, "step.functionality.st_funcmodel.stSmoother._gener_graph"]], "_num_batches (stsmoother attribute)": [[8, "step.functionality.st_funcmodel.stSmoother._num_batches"]], "embed() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.embed"]], "from_spatial_graph() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.from_spatial_graph"]], "gembed() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.gembed"]], "handle_ginput_tuple() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.handle_ginput_tuple"]], "handle_input_tuple() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.handle_input_tuple"]], "loss_gbatch() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.loss_gbatch"]], "model (stsmoother attribute)": [[8, "step.functionality.st_funcmodel.stSmoother.model"]], "reset_model() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.reset_model"]], "run() (stsmoother method)": [[8, "step.functionality.st_funcmodel.stSmoother.run"]], "stsmoother (class in step.functionality.st_funcmodel)": [[8, "step.functionality.st_funcmodel.stSmoother"]], "step.functionality.st_funcmodel": [[8, "module-step.functionality.st_funcmodel"]], "use_earlystop (stsmoother attribute)": [[8, "step.functionality.st_funcmodel.stSmoother.use_earlystop"]], "step": [[9, "module-step"]], "_functional (crossmodel attribute)": [[10, "step.integration.crossModel._functional"]], "adata (crossmodel attribute)": [[10, "step.integration.crossModel.adata"]], "adata (crossmodel property)": [[10, "id0"]], "cluster() (crossmodel method)": [[10, "step.integration.crossModel.cluster"]], "crossmodel (class in step.integration)": [[10, "step.integration.crossModel"]], "dataset (crossmodel attribute)": [[10, "step.integration.crossModel.dataset"]], "load() (crossmodel class method)": [[10, "step.integration.crossModel.load"]], "model (crossmodel property)": [[10, "step.integration.crossModel.model"]], "save() (crossmodel method)": [[10, "step.integration.crossModel.save"]], "spatial_plot() (crossmodel method)": [[10, "step.integration.crossModel.spatial_plot"]], "st_adata (crossmodel attribute)": [[10, "step.integration.crossModel.st_adata"]], "st_adata (crossmodel property)": [[10, "id1"]], "step.integration": [[10, "module-step.integration"]], "sub_cluster() (crossmodel method)": [[10, "step.integration.crossModel.sub_cluster"]], "summarize_domain() (crossmodel method)": [[10, "step.integration.crossModel.summarize_domain"]], "summarize_single_domain() (crossmodel method)": [[10, "step.integration.crossModel.summarize_single_domain"]], "customformatter (class in step.manager)": [[11, "step.manager.CustomFormatter"]], "ch (in module step.manager)": [[11, "step.manager.ch"]], "format() (customformatter method)": [[11, "step.manager.CustomFormatter.format"]], "formatter (in module step.manager)": [[11, "step.manager.formatter"]], "logger (in module step.manager)": [[11, "step.manager.logger"]], "set_verbosity() (in module step.manager)": [[11, "step.manager.set_verbosity"]], "step.manager": [[11, "module-step.manager"]], "saver (class in step.manager.save)": [[12, "step.manager.save.Saver"]], "adata (saver attribute)": [[12, "step.manager.save.Saver.adata"]], "dataset (saver attribute)": [[12, "step.manager.save.Saver.dataset"]], "funcmodel (saver attribute)": [[12, "step.manager.save.Saver.funcmodel"]], "get_instance() (saver class method)": [[12, "step.manager.save.Saver.get_instance"]], "save() (saver method)": [[12, "step.manager.save.Saver.save"]], "step.manager.save": [[12, "module-step.manager.save"]], "clustergeneric (class in step.models.clust)": [[13, "step.models.clust.ClusterGeneric"]], "kmeans() (in module step.models.clust)": [[13, "step.models.clust.kmeans"]], "mclust_r() (in module step.models.clust)": [[13, "step.models.clust.mclust_R"]], "method (clustergeneric attribute)": [[13, "step.models.clust.ClusterGeneric.method"]], "seed (clustergeneric attribute)": [[13, "step.models.clust.ClusterGeneric.seed"]], "step.models.clust": [[13, "module-step.models.clust"]], "mixer (class in step.models.deconv)": [[14, "step.models.deconv.Mixer"]], "t (mixer attribute)": [[14, "step.models.deconv.Mixer.T"]], "t (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.T"]], "topnattention (class in step.models.deconv)": [[14, "step.models.deconv.TopNAttention"]], "act (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.act"]], "alpha (mixer attribute)": [[14, "step.models.deconv.Mixer.alpha"]], "anchors (mixer attribute)": [[14, "step.models.deconv.Mixer.anchors"]], "anchors_ (mixer property)": [[14, "step.models.deconv.Mixer.anchors_"]], "domain_wise (mixer attribute)": [[14, "step.models.deconv.Mixer.domain_wise"]], "embed_dim (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.embed_dim"]], "forward() (mixer method)": [[14, "step.models.deconv.Mixer.forward"]], "forward() (topnattention method)": [[14, "step.models.deconv.TopNAttention.forward"]], "g (mixer attribute)": [[14, "step.models.deconv.Mixer.g"]], "get_prop() (mixer method)": [[14, "step.models.deconv.Mixer.get_prop"]], "get_scores() (mixer method)": [[14, "step.models.deconv.Mixer.get_scores"]], "hard_anchors (mixer attribute)": [[14, "step.models.deconv.Mixer.hard_anchors"]], "hidden_dim (mixer attribute)": [[14, "step.models.deconv.Mixer.hidden_dim"]], "inf_pz() (mixer method)": [[14, "step.models.deconv.Mixer.inf_pz"]], "kv (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.kv"]], "mask_prop() (mixer method)": [[14, "step.models.deconv.Mixer.mask_prop"]], "max_ct_per_spot (mixer attribute)": [[14, "step.models.deconv.Mixer.max_ct_per_spot"]], "n_layers (mixer attribute)": [[14, "step.models.deconv.Mixer.n_layers"]], "n_spots (mixer attribute)": [[14, "step.models.deconv.Mixer.n_spots"]], "num_heads (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.num_heads"]], "out (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.out"]], "p_hat() (mixer method)": [[14, "step.models.deconv.Mixer.p_hat"]], "params() (mixer method)": [[14, "step.models.deconv.Mixer.params"]], "phat_params() (mixer method)": [[14, "step.models.deconv.Mixer.phat_params"]], "q (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.q"]], "rate (mixer attribute)": [[14, "step.models.deconv.Mixer.rate"]], "sc_consistency() (mixer method)": [[14, "step.models.deconv.Mixer.sc_consistency"]], "signatures (mixer attribute)": [[14, "step.models.deconv.Mixer.signatures"]], "smoother (mixer attribute)": [[14, "step.models.deconv.Mixer.smoother"]], "solver (mixer attribute)": [[14, "step.models.deconv.Mixer.solver"]], "step.models.deconv": [[14, "module-step.models.deconv"]], "top_n (topnattention attribute)": [[14, "step.models.deconv.TopNAttention.top_n"]], "ts_forward() (mixer method)": [[14, "step.models.deconv.Mixer.ts_forward"]], "use_smoother (mixer attribute)": [[14, "step.models.deconv.Mixer.use_smoother"]], "negativebinomial (class in step.models.distributions)": [[15, "step.models.distributions.NegativeBinomial"]], "zeroinflatednegativebinomial (class in step.models.distributions)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial"]], "arg_constraints (negativebinomial attribute)": [[15, "step.models.distributions.NegativeBinomial.arg_constraints"]], "arg_constraints (zeroinflatednegativebinomial attribute)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.arg_constraints"]], "log_mixture_nb() (in module step.models.distributions)": [[15, "step.models.distributions.log_mixture_nb"]], "log_nb_positive() (in module step.models.distributions)": [[15, "step.models.distributions.log_nb_positive"]], "log_prob() (negativebinomial method)": [[15, "step.models.distributions.NegativeBinomial.log_prob"]], "log_prob() (zeroinflatednegativebinomial method)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.log_prob"]], "log_zinb_positive() (in module step.models.distributions)": [[15, "step.models.distributions.log_zinb_positive"]], "mean (negativebinomial property)": [[15, "step.models.distributions.NegativeBinomial.mean"]], "mean (zeroinflatednegativebinomial property)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.mean"]], "pearson_residuals() (negativebinomial method)": [[15, "step.models.distributions.NegativeBinomial.pearson_residuals"]], "rsample() (negativebinomial method)": [[15, "step.models.distributions.NegativeBinomial.rsample"]], "rsample() (zeroinflatednegativebinomial method)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.rsample"]], "sample() (negativebinomial method)": [[15, "step.models.distributions.NegativeBinomial.sample"]], "sample() (zeroinflatednegativebinomial method)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.sample"]], "step.models.distributions": [[15, "module-step.models.distributions"]], "support (negativebinomial attribute)": [[15, "step.models.distributions.NegativeBinomial.support"]], "support (zeroinflatednegativebinomial attribute)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.support"]], "variance (negativebinomial property)": [[15, "step.models.distributions.NegativeBinomial.variance"]], "variance (zeroinflatednegativebinomial property)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.variance"]], "zi_logits() (zeroinflatednegativebinomial method)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.zi_logits"]], "zi_probs() (zeroinflatednegativebinomial method)": [[15, "step.models.distributions.ZeroInflatedNegativeBinomial.zi_probs"]], "batchawarelayernorm (class in step.models.extension)": [[16, "step.models.extension.BatchAwareLayerNorm"]], "batchawarescale (class in step.models.extension)": [[16, "step.models.extension.BatchAwareScale"]], "nrmlsbc (class in step.models.extension)": [[16, "step.models.extension.NrmlsBC"]], "act (batchawarelayernorm attribute)": [[16, "step.models.extension.BatchAwareLayerNorm.act"]], "act (batchawarescale attribute)": [[16, "step.models.extension.BatchAwareScale.act"]], "args (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.args"]], "batch_emb_dim (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.batch_emb_dim"]], "batch_embedding (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.batch_embedding"]], "batch_readout (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.batch_readout"]], "copy() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.copy"]], "copy_dec() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.copy_dec"]], "decode() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.decode"]], "decode_() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.decode_"]], "decode_skip() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.decode_skip"]], "decode_ts() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.decode_ts"]], "encode() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.encode"]], "encode_ts() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.encode_ts"]], "forward() (batchawarelayernorm method)": [[16, "step.models.extension.BatchAwareLayerNorm.forward"]], "forward() (batchawarescale method)": [[16, "step.models.extension.BatchAwareScale.forward"]], "forward() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.forward"]], "init_anchor() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.init_anchor"]], "layernorm (batchawarelayernorm attribute)": [[16, "step.models.extension.BatchAwareLayerNorm.layernorm"]], "mean (batchawarelayernorm attribute)": [[16, "step.models.extension.BatchAwareLayerNorm.mean"]], "moduler (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.moduler"]], "net (batchawarescale attribute)": [[16, "step.models.extension.BatchAwareScale.net"]], "non_decoder_param (nrmlsbc property)": [[16, "step.models.extension.NrmlsBC.non_decoder_param"]], "num_batches (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.num_batches"]], "readout_() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.readout_"]], "readout_batch() (nrmlsbc method)": [[16, "step.models.extension.NrmlsBC.readout_batch"]], "scale (batchawarelayernorm attribute)": [[16, "step.models.extension.BatchAwareLayerNorm.scale"]], "smoother (nrmlsbc attribute)": [[16, "step.models.extension.NrmlsBC.smoother"]], "step.models.extension": [[16, "module-step.models.extension"]], "genemoduler (class in step.models.geneformer)": [[17, "step.models.geneformer.GeneModuler"]], "geneformer (class in step.models.geneformer)": [[17, "step.models.geneformer.Geneformer"]], "linear2d (class in step.models.geneformer)": [[17, "step.models.geneformer.Linear2D"]], "readout (class in step.models.geneformer)": [[17, "step.models.geneformer.Readout"]], "_smooth (geneformer attribute)": [[17, "step.models.geneformer.Geneformer._smooth"]], "args (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.args"]], "clear() (readout method)": [[17, "step.models.geneformer.Readout.clear"]], "cls_token (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.cls_token"]], "copy() (geneformer method)": [[17, "step.models.geneformer.Geneformer.copy"]], "decode() (geneformer method)": [[17, "step.models.geneformer.Geneformer.decode"]], "decode_ts() (geneformer method)": [[17, "step.models.geneformer.Geneformer.decode_ts"]], "decoder (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.decoder"]], "decoder_type (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.decoder_type"]], "demodule() (genemoduler method)": [[17, "step.models.geneformer.GeneModuler.demodule"]], "drop_edge (in module step.models.geneformer)": [[17, "step.models.geneformer.drop_edge"]], "encode() (geneformer method)": [[17, "step.models.geneformer.Geneformer.encode"]], "encode_ts() (geneformer method)": [[17, "step.models.geneformer.Geneformer.encode_ts"]], "expand (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.expand"]], "extractor (genemoduler attribute)": [[17, "step.models.geneformer.GeneModuler.extractor"]], "forward() (genemoduler method)": [[17, "step.models.geneformer.GeneModuler.forward"]], "forward() (geneformer method)": [[17, "step.models.geneformer.Geneformer.forward"]], "forward() (linear2d method)": [[17, "step.models.geneformer.Linear2D.forward"]], "forward() (readout method)": [[17, "step.models.geneformer.Readout.forward"]], "gargs (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.gargs"]], "get_px_r() (geneformer method)": [[17, "step.models.geneformer.Geneformer.get_px_r"]], "hidden_dim (genemoduler attribute)": [[17, "step.models.geneformer.GeneModuler.hidden_dim"]], "hidden_dim (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.hidden_dim"]], "init_smoother() (geneformer method)": [[17, "step.models.geneformer.Geneformer.init_smoother"]], "init_smoother_with_builtin() (geneformer method)": [[17, "step.models.geneformer.Geneformer.init_smoother_with_builtin"]], "input_dim (genemoduler attribute)": [[17, "step.models.geneformer.GeneModuler.input_dim"]], "input_dim (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.input_dim"]], "kl_loss() (readout method)": [[17, "step.models.geneformer.Readout.kl_loss"]], "layernorm (genemoduler attribute)": [[17, "step.models.geneformer.GeneModuler.layernorm"]], "local_smooth() (geneformer method)": [[17, "step.models.geneformer.Geneformer.local_smooth"]], "logvar (readout attribute)": [[17, "step.models.geneformer.Readout.logvar"]], "mean (readout attribute)": [[17, "step.models.geneformer.Readout.mean"]], "module (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.module"]], "module_dim (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.module_dim"]], "moduler (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.moduler"]], "n_modules (genemoduler attribute)": [[17, "step.models.geneformer.GeneModuler.n_modules"]], "n_modules (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.n_modules"]], "net (readout attribute)": [[17, "step.models.geneformer.Readout.net"]], "out (readout attribute)": [[17, "step.models.geneformer.Readout.out"]], "px_r (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.px_r"]], "random_permute() (genemoduler method)": [[17, "step.models.geneformer.GeneModuler.random_permute"]], "readout (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.readout"]], "readout_() (geneformer method)": [[17, "step.models.geneformer.Geneformer.readout_"]], "smoother (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.smoother"]], "smoother_type (geneformer attribute)": [[17, "step.models.geneformer.Geneformer.smoother_type"]], "step.models.geneformer": [[17, "module-step.models.geneformer"]], "variational (readout attribute)": [[17, "step.models.geneformer.Readout.variational"]], "step.models": [[18, "module-step.models"]], "knn_random_coords() (in module step.models.knn_map)": [[19, "step.models.knn_map.knn_random_coords"]], "step.models.knn_map": [[19, "module-step.models.knn_map"]], "nnls_deconv() (in module step.models.nnls)": [[20, "step.models.nnls.nnls_deconv"]], "step.models.nnls": [[20, "module-step.models.nnls"]], "exp (class in step.modules.decoder)": [[21, "step.modules.decoder.Exp"]], "probdecoder (class in step.modules.decoder)": [[21, "step.modules.decoder.ProbDecoder"]], "args (probdecoder attribute)": [[21, "step.modules.decoder.ProbDecoder.args"]], "copy() (probdecoder method)": [[21, "step.modules.decoder.ProbDecoder.copy"]], "dropout_() (probdecoder method)": [[21, "step.modules.decoder.ProbDecoder.dropout_"]], "ffn_() (probdecoder method)": [[21, "step.modules.decoder.ProbDecoder.ffn_"]], "forward() (exp method)": [[21, "step.modules.decoder.Exp.forward"]], "forward() (probdecoder method)": [[21, "step.modules.decoder.ProbDecoder.forward"]], "step.modules.decoder": [[21, "module-step.modules.decoder"]], "gat (class in step.modules.gnn)": [[22, "step.modules.gnn.GAT"]], "gcn (class in step.modules.gnn)": [[22, "step.modules.gnn.GCN"]], "forward() (gat method)": [[22, "step.modules.gnn.GAT.forward"]], "forward() (gcn method)": [[22, "step.modules.gnn.GCN.forward"]], "h_feats (gcn attribute)": [[22, "step.modules.gnn.GCN.h_feats"]], "in_feats (gcn attribute)": [[22, "step.modules.gnn.GCN.in_feats"]], "n_layers (gcn attribute)": [[22, "step.modules.gnn.GCN.n_layers"]], "step.modules.gnn": [[22, "module-step.modules.gnn"]], "with_edge (gcn attribute)": [[22, "step.modules.gnn.GCN.with_edge"]], "step.modules": [[23, "module-step.modules"]], "attention (class in step.modules.transformer)": [[24, "step.modules.transformer.Attention"]], "feedforward (class in step.modules.transformer)": [[24, "step.modules.transformer.FeedForward"]], "prenorm (class in step.modules.transformer)": [[24, "step.modules.transformer.PreNorm"]], "transformer (class in step.modules.transformer)": [[24, "step.modules.transformer.Transformer"]], "exists() (in module step.modules.transformer)": [[24, "step.modules.transformer.exists"]], "forward() (attention method)": [[24, "step.modules.transformer.Attention.forward"]], "forward() (feedforward method)": [[24, "step.modules.transformer.FeedForward.forward"]], "forward() (prenorm method)": [[24, "step.modules.transformer.PreNorm.forward"]], "forward() (transformer method)": [[24, "step.modules.transformer.Transformer.forward"]], "pair() (in module step.modules.transformer)": [[24, "step.modules.transformer.pair"]], "softmax_one() (in module step.modules.transformer)": [[24, "step.modules.transformer.softmax_one"]], "step.modules.transformer": [[24, "module-step.modules.transformer"]], "_functional (scmodel attribute)": [[25, "step.scmodel.scModel._functional"]], "adata (scmodel attribute)": [[25, "step.scmodel.scModel.adata"]], "adata (scmodel property)": [[25, "id0"]], "dataset (scmodel attribute)": [[25, "step.scmodel.scModel.dataset"]], "load() (scmodel class method)": [[25, "step.scmodel.scModel.load"]], "load_checkpoint() (scmodel method)": [[25, "step.scmodel.scModel.load_checkpoint"]], "model (scmodel property)": [[25, "step.scmodel.scModel.model"]], "save() (scmodel method)": [[25, "step.scmodel.scModel.save"]], "scmodel (class in step.scmodel)": [[25, "step.scmodel.scModel"]], "step.scmodel": [[25, "module-step.scmodel"]], "_functional (stmodel attribute)": [[26, "step.stmodel.stModel._functional"]], "adata (stmodel attribute)": [[26, "step.stmodel.stModel.adata"]], "adata (stmodel property)": [[26, "id0"]], "cluster() (stmodel method)": [[26, "step.stmodel.stModel.cluster"]], "dataset (stmodel attribute)": [[26, "step.stmodel.stModel.dataset"]], "load() (stmodel class method)": [[26, "step.stmodel.stModel.load"]], "model (stmodel property)": [[26, "step.stmodel.stModel.model"]], "save() (stmodel method)": [[26, "step.stmodel.stModel.save"]], "spatial_plot() (stmodel method)": [[26, "step.stmodel.stModel.spatial_plot"]], "stmodel (class in step.stmodel)": [[26, "step.stmodel.stModel"]], "step.stmodel": [[26, "module-step.stmodel"]], "sub_cluster() (stmodel method)": [[26, "step.stmodel.stModel.sub_cluster"]], "summarize_domain() (stmodel method)": [[26, "step.stmodel.stModel.summarize_domain"]], "summarize_single_domain() (stmodel method)": [[26, "step.stmodel.stModel.summarize_single_domain"]], "basedataset (class in step.utils.dataset)": [[27, "step.utils.dataset.BaseDataset"]], "crossdataset (class in step.utils.dataset)": [[27, "step.utils.dataset.CrossDataset"]], "maskeddataset (class in step.utils.dataset)": [[27, "step.utils.dataset.MaskedDataset"]], "process_fields (in module step.utils.dataset)": [[27, "step.utils.dataset.PROCESS_FIELDS"]], "read_fields (in module step.utils.dataset)": [[27, "step.utils.dataset.READ_FIELDS"]], "recieve_fields (in module step.utils.dataset)": [[27, "step.utils.dataset.RECIEVE_FIELDS"]], "scdataset (class in step.utils.dataset)": [[27, "step.utils.dataset.ScDataset"]], "scmode (class in step.utils.dataset)": [[27, "step.utils.dataset.ScMode"]], "stdataset (class in step.utils.dataset)": [[27, "step.utils.dataset.StDataset"]], "stmode (class in step.utils.dataset)": [[27, "step.utils.dataset.StMode"]], "_indices (maskeddataset attribute)": [[27, "step.utils.dataset.MaskedDataset._indices"]], "_integrated (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset._integrated"]], "_mask (maskeddataset attribute)": [[27, "step.utils.dataset.MaskedDataset._mask"]], "adata (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.adata"]], "adata (maskeddataset property)": [[27, "step.utils.dataset.MaskedDataset.adata"]], "batch_codes (basedataset property)": [[27, "step.utils.dataset.BaseDataset.batch_codes"]], "batch_key (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.batch_key"]], "batch_key (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.batch_key"]], "batch_names (basedataset property)": [[27, "step.utils.dataset.BaseDataset.batch_names"]], "class_codes (basedataset property)": [[27, "step.utils.dataset.BaseDataset.class_codes"]], "class_key (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.class_key"]], "class_key (scdataset attribute)": [[27, "step.utils.dataset.ScDataset.class_key"]], "coord_keys (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.coord_keys"]], "coord_keys (stdataset attribute)": [[27, "step.utils.dataset.StDataset.coord_keys"]], "domains (stdataset attribute)": [[27, "step.utils.dataset.StDataset.domains"]], "filtered (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.filtered"]], "geneset (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.geneset"]], "get() (basedataset method)": [[27, "step.utils.dataset.BaseDataset.get"]], "hvg_method (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.hvg_method"]], "is_human (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.is_human"]], "layer_key (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.layer_key"]], "log_transformed (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.log_transformed"]], "logarithm_first (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.logarithm_first"]], "masked_num_batches (maskeddataset property)": [[27, "step.utils.dataset.MaskedDataset.masked_num_batches"]], "masked_num_classes (maskeddataset property)": [[27, "step.utils.dataset.MaskedDataset.masked_num_classes"]], "mode (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.mode"]], "mode (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.mode"]], "mode (maskeddataset property)": [[27, "step.utils.dataset.MaskedDataset.mode"]], "mode (scdataset attribute)": [[27, "step.utils.dataset.ScDataset.mode"]], "mode (stdataset attribute)": [[27, "step.utils.dataset.StDataset.mode"]], "multi_batches (scmode attribute)": [[27, "id1"], [27, "step.utils.dataset.ScMode.multi_batches"]], "multi_batches (stmode attribute)": [[27, "id4"], [27, "step.utils.dataset.StMode.multi_batches"]], "multi_batches_with_ct (scmode attribute)": [[27, "id2"], [27, "step.utils.dataset.ScMode.multi_batches_with_ct"]], "n_genes (basedataset property)": [[27, "step.utils.dataset.BaseDataset.n_genes"]], "n_top_genes (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.n_top_genes"]], "num_batches (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.num_batches"]], "num_classes (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.num_classes"]], "num_classes (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.num_classes"]], "num_classes (scdataset attribute)": [[27, "step.utils.dataset.ScDataset.num_classes"]], "num_st_batches (crossdataset property)": [[27, "step.utils.dataset.CrossDataset.num_st_batches"]], "original_dataset (maskeddataset attribute)": [[27, "step.utils.dataset.MaskedDataset.original_dataset"]], "process() (basedataset method)": [[27, "step.utils.dataset.BaseDataset.process"]], "process_fields (basedataset attribute)": [[27, "id8"], [27, "step.utils.dataset.BaseDataset.process_fields"]], "process_fields (crossdataset attribute)": [[27, "id17"], [27, "step.utils.dataset.CrossDataset.process_fields"]], "process_fields (scdataset attribute)": [[27, "id13"], [27, "step.utils.dataset.ScDataset.process_fields"]], "process_fields (stdataset attribute)": [[27, "step.utils.dataset.StDataset.process_fields"]], "read() (basedataset class method)": [[27, "step.utils.dataset.BaseDataset.read"]], "read() (crossdataset class method)": [[27, "step.utils.dataset.CrossDataset.read"]], "read_fields (basedataset attribute)": [[27, "id7"], [27, "step.utils.dataset.BaseDataset.read_fields"]], "read_fields (scdataset attribute)": [[27, "id11"], [27, "step.utils.dataset.ScDataset.read_fields"]], "read_fields (stdataset attribute)": [[27, "id16"], [27, "step.utils.dataset.StDataset.read_fields"]], "read_folder (basedataset attribute)": [[27, "step.utils.dataset.BaseDataset.read_folder"]], "read_folder (scdataset attribute)": [[27, "id14"], [27, "step.utils.dataset.ScDataset.read_folder"]], "read_folder (stdataset attribute)": [[27, "id15"], [27, "step.utils.dataset.StDataset.read_folder"]], "read_folder() (basedataset method)": [[27, "id10"]], "recieve_fields (basedataset attribute)": [[27, "id9"], [27, "step.utils.dataset.BaseDataset.recieve_fields"]], "recieve_fields (crossdataset attribute)": [[27, "id18"], [27, "step.utils.dataset.CrossDataset.recieve_fields"]], "recieve_fields (scdataset attribute)": [[27, "id12"], [27, "step.utils.dataset.ScDataset.recieve_fields"]], "recieve_fields (stdataset attribute)": [[27, "step.utils.dataset.StDataset.recieve_fields"]], "rep (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.rep"]], "rep (stdataset attribute)": [[27, "step.utils.dataset.StDataset.rep"]], "set_domains() (stdataset method)": [[27, "step.utils.dataset.StDataset.set_domains"]], "set_mode() (crossdataset method)": [[27, "step.utils.dataset.CrossDataset.set_mode"]], "set_mode() (maskeddataset method)": [[27, "step.utils.dataset.MaskedDataset.set_mode"]], "set_mode() (scdataset method)": [[27, "step.utils.dataset.ScDataset.set_mode"]], "set_mode() (stdataset method)": [[27, "step.utils.dataset.StDataset.set_mode"]], "set_prior_coef() (stdataset method)": [[27, "step.utils.dataset.StDataset.set_prior_coef"]], "set_rep() (crossdataset method)": [[27, "step.utils.dataset.CrossDataset.set_rep"]], "single_batch (scmode attribute)": [[27, "id0"], [27, "step.utils.dataset.ScMode.single_batch"]], "single_batch (stmode attribute)": [[27, "id3"], [27, "step.utils.dataset.StMode.single_batch"]], "st_adata (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.st_adata"]], "st_batch_codes (crossdataset property)": [[27, "step.utils.dataset.CrossDataset.st_batch_codes"]], "st_sample_list (crossdataset property)": [[27, "step.utils.dataset.CrossDataset.st_sample_list"]], "st_sample_names (crossdataset attribute)": [[27, "step.utils.dataset.CrossDataset.st_sample_names"]], "step.utils.dataset": [[27, "module-step.utils.dataset"]], "subset() (basedataset method)": [[27, "step.utils.dataset.BaseDataset.subset"]], "subset() (maskeddataset method)": [[27, "step.utils.dataset.MaskedDataset.subset"]], "subset_st() (crossdataset method)": [[27, "step.utils.dataset.CrossDataset.subset_st"]], "switch_layer() (basedataset method)": [[27, "step.utils.dataset.BaseDataset.switch_layer"]], "with_domains (stmode attribute)": [[27, "id6"], [27, "step.utils.dataset.StMode.with_domains"]], "with_rep (stmode attribute)": [[27, "id5"], [27, "step.utils.dataset.StMode.with_rep"]], "multigraphsallnodessampler (class in step.utils.gbolt)": [[28, "step.utils.gbolt.MultiGraphsAllNodesSampler"]], "n_graphs (multigraphsallnodessampler attribute)": [[28, "step.utils.gbolt.MultiGraphsAllNodesSampler.n_graphs"]], "node_sampler() (multigraphsallnodessampler method)": [[28, "step.utils.gbolt.MultiGraphsAllNodesSampler.node_sampler"]], "step.utils.gbolt": [[28, "module-step.utils.gbolt"]], "step.utils": [[29, "module-step.utils"]], "geary_c() (in module step.utils.metrics)": [[30, "step.utils.metrics.geary_c"]], "moran_i() (in module step.utils.metrics)": [[30, "step.utils.metrics.moran_i"]], "step.utils.metrics": [[30, "module-step.utils.metrics"]], "aver_items_by_ct() (in module step.utils.misc)": [[31, "step.utils.misc.aver_items_by_ct"]], "compute_selfattention() (in module step.utils.misc)": [[31, "step.utils.misc.compute_selfattention"]], "extract_selfattention_maps() (in module step.utils.misc)": [[31, "step.utils.misc.extract_selfattention_maps"]], "generate_adj() (in module step.utils.misc)": [[31, "step.utils.misc.generate_adj"]], "get_de_genes() (in module step.utils.misc)": [[31, "step.utils.misc.get_de_genes"]], "read_visium_hd() (in module step.utils.misc)": [[31, "step.utils.misc.read_visium_hd"]], "set_seed() (in module step.utils.misc)": [[31, "step.utils.misc.set_seed"]], "step.utils.misc": [[31, "module-step.utils.misc"]], "plot_domain_summary() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_domain_summary"]], "plot_domain_summary_single_ct() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_domain_summary_single_ct"]], "plot_posterior_mu_vs_data() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_posterior_mu_vs_data"]], "plot_single_domain_summary() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_single_domain_summary"]], "plot_spatial_pie_charts() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_spatial_pie_charts"]], "plot_trajectory() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_trajectory"]], "plot_trajectory_curve() (in module step.utils.plotting)": [[32, "step.utils.plotting.plot_trajectory_curve"]], "set_cmap() (in module step.utils.plotting)": [[32, "step.utils.plotting.set_cmap"]], "spatial_plot() (in module step.utils.plotting)": [[32, "step.utils.plotting.spatial_plot"]], "step.utils.plotting": [[32, "module-step.utils.plotting"]], "step.utils.synthetics": [[33, "module-step.utils.synthetics"]], "pseudost (class in step.utils.synthetics.pseudo_st)": [[34, "step.utils.synthetics.pseudo_st.PseudoST"]], "adata_sc (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.adata_sc"]], "adata_st (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.adata_st"]], "batch_key (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.batch_key"]], "cell_type_key (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.cell_type_key"]], "coords_key (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.coords_key"]], "downsapmle_size (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.downsapmle_size"]], "info_key (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.info_key"]], "k_hop (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.k_hop"]], "layer_key (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.layer_key"]], "save() (pseudost method)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.save"]], "simulate() (pseudost method)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.simulate"]], "step.utils.synthetics.pseudo_st": [[34, "module-step.utils.synthetics.pseudo_st"]], "sub_type_key (pseudost attribute)": [[34, "step.utils.synthetics.pseudo_st.PseudoST.sub_type_key"]]}})