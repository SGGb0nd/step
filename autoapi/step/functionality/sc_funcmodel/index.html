<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="step.functionality.st_funcmodel" href="../st_funcmodel/index.html" /><link rel="prev" title="step.functionality.cross_funcmodel" href="../cross_funcmodel/index.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.01.29 -->
        <title>step.functionality.sc_funcmodel - STEP documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css?v=f8d6e08a" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">STEP  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">STEP  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../index.html#usage">Usage</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Usage</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../usages/entries.html">EntryPoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../usages/results.html">Results Storage</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../index.html#tutorials">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../notebooks/DLFPC.html">Spatial domain identification on 10x Visium DLFPC data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../notebooks/Human_Lymph_Node.html">Performing integrative analysis on scRNA-seq data and 10x Visium data of Human Lymph Node with STEP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../notebooks/MERFISH.html">Reveal multiple level of biological heterogeneities in Mouse Hypothalamus by MERFISH-seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../notebooks/scRNA-seq.html">Integrate Human Immune Cell datasets with STEP and generate batch-corrected embeddings and gene expressions.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../notebooks/human_colorectal_cancer.html">Visium HD Human Colorectal Cancer (16 um) cell type clustering &amp; spatial domain identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../notebooks/mouse_small_intestine.html">Visium HD Mouse Small Intestine (8 um and 16 um) cell type clustering &amp; spatial domain identification</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../index.html#api-reference">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of step</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current has-children"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of step.functionality</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4 has-children"><a class="reference internal" href="../comps/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.comps</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of step.functionality.comps</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../comps/model_ops/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.comps.model_ops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../comps/trainer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.comps.trainer</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../base/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.base</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../cross_funcmodel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.cross_funcmodel</span></code></a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.sc_funcmodel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../st_funcmodel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.st_funcmodel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../manager/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.manager</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of step.manager</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../manager/save/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.manager.save</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../models/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of step.models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../models/clust/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.clust</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/deconv/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.deconv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/distributions/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.distributions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/extension/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.extension</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/knn_map/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.knn_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/nnls/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.nnls</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/transcriptformer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.models.transcriptformer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../modules/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.modules</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of step.modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../modules/decoder/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.modules.decoder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../modules/gnn/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.modules.gnn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../modules/transformer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.modules.transformer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of step.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../utils/synthetics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.synthetics</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of step.utils.synthetics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../utils/synthetics/pseudo_st/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.synthetics.pseudo_st</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/dataset/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/gbolt/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.gbolt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.metrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/misc/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.misc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/plotting/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.utils.plotting</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../integration/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.integration</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scmodel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.scmodel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stmodel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.stmodel</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/SGGb0nd/step/edit/main/docs/autoapi/step/functionality/sc_funcmodel/index.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-step.functionality.sc_funcmodel">
<span id="step-functionality-sc-funcmodel"></span><h1><a class="reference internal" href="#module-step.functionality.sc_funcmodel" title="step.functionality.sc_funcmodel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.sc_funcmodel</span></code></a><a class="headerlink" href="#module-step.functionality.sc_funcmodel" title="Link to this heading">¶</a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#step.functionality.sc_funcmodel.scSingleBatch" title="step.functionality.sc_funcmodel.scSingleBatch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scSingleBatch</span></code></a></p></td>
<td><p>scSingleBatch model for scRNA-seq data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls" title="step.functionality.sc_funcmodel.scMultiBatchNrmls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scMultiBatchNrmls</span></code></a></p></td>
<td><p>scMultiBatchNrmls model for multi-batch scRNA-seq data.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scSingleBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scSingleBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scSingleBatch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../base/index.html#step.functionality.base.FunctionalBase" title="step.functionality.base.FunctionalBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">step.functionality.base.FunctionalBase</span></code></a></p>
<p>scSingleBatch model for scRNA-seq data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scSingleBatch.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#step.functionality.sc_funcmodel.scSingleBatch.model" title="Link to this definition">¶</a></dt>
<dd><p>The model used for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../models/transcriptformer/index.html#step.models.transcriptformer.TranscriptFormer" title="step.models.transcriptformer.TranscriptFormer">TranscriptFormer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scSingleBatch.handle_input_tuple">
<span class="sig-name descname"><span class="pre">handle_input_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tuple</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scSingleBatch.handle_input_tuple" title="Link to this definition">¶</a></dt>
<dd><p>Handles the input tuple and calculates the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_tuple</strong> (<em>tuple</em>) – A tuple containing the input data and the target data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the loss values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scMultiBatchNrmls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../base/index.html#step.functionality.base.FunctionalBase" title="step.functionality.base.FunctionalBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">step.functionality.base.FunctionalBase</span></code></a></p>
<p>scMultiBatchNrmls model for multi-batch scRNA-seq data.</p>
<p>This class provides an interface for training and using the extension of the backbone model for multi-batch scRNA-seq data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.model" title="Link to this definition">¶</a></dt>
<dd><p>The model used for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../models/extension/index.html#step.models.extension.NrmlsBC" title="step.models.extension.NrmlsBC">NrmlsBC</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls._factor">
<span class="sig-name descname"><span class="pre">_factor</span></span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls._factor" title="Link to this definition">¶</a></dt>
<dd><p>The beta factor for tuning the kl loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.loss" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the loss function for the model.
The internal loss function is selected based on the availability of class labels, for semi-supervised and unsupervised settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The input data.</p></li>
<li><p><strong>batch_rep</strong> (<em>Tensor</em>) – The batch representation.</p></li>
<li><p><strong>class_label</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – The class label (default: None).</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – The beta parameter for tuning the loss (default: 1e-2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated loss value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.train" title="Link to this definition">¶</a></dt>
<dd><p>Train the model using the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>dict</em>) – The state dictionary containing training parameters.</p></li>
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – The input data.</p></li>
<li><p><strong>train_ind</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of the training data.</p></li>
<li><p><strong>valid_ind</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of the validation data.</p></li>
<li><p><strong>call_func</strong> (<em>Optional</em><em>[</em><em>Callable</em><em>]</em>) – The function to calculate the loss.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the loss function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if early stopping condition is met, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.handle_input_tuple">
<span class="sig-name descname"><span class="pre">handle_input_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tuple</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.handle_input_tuple" title="Link to this definition">¶</a></dt>
<dd><p>Handles the input tuple and calculates the loss.
This method is implemented to handle the input tuple and calculate the loss for <cite>train_batch</cite> method, see <cite>train_batch</cite> in parent class <cite>FunctionalBase</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tuple</strong> (<em>tuple</em>) – The input tuple containing the data and labels.</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – The beta value for the loss calculation. Defaults to 1e-2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the loss values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.embed">
<span class="sig-name descname"><span class="pre">embed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsfmr_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.embed" title="Link to this definition">¶</a></dt>
<dd><p>Embeds the given dataset using the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – The dataset to be embedded.</p></li>
<li><p><strong>tsfmr_out</strong> – Whether to return the output of the transformer layer. Defaults to False.</p></li>
<li><p><strong>as_numpy</strong> – Whether to return the embeddings as numpy arrays. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The embeddings of the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.get_anchors">
<span class="sig-name descname"><span class="pre">get_anchors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.get_anchors" title="Link to this definition">¶</a></dt>
<dd><p>Returns the anchors used by the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An array of anchors.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.BaseDataset" title="step.utils.dataset.BaseDataset"><span class="pre">step.utils.dataset.BaseDataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.MaskedDataset" title="step.utils.dataset.MaskedDataset"><span class="pre">step.utils.dataset.MaskedDataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">need_anchors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlabeled_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_rep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.run" title="Link to this definition">¶</a></dt>
<dd><p>Run the function model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – The annotated data matrix.</p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.BaseDataset" title="step.utils.dataset.BaseDataset"><em>BaseDataset</em></a>) – The dataset object.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – The number of training epochs. Default is 1.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size. Default is None.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – The learning rate. Default is 1e-3.</p></li>
<li><p><strong>split_rate</strong> (<em>float</em>) – The split rate for train-test split. Default is 0.2.</p></li>
<li><p><strong>tune_epochs</strong> (<em>int</em>) – The number of finetuning epochs. Default is 20.</p></li>
<li><p><strong>tune_lr</strong> (<em>float</em>) – The learning rate for finetuning. Default is 1e-4.</p></li>
<li><p><strong>need_anchors</strong> (<em>bool</em>) – Whether to use anchors. Default is True.</p></li>
<li><p><strong>unlabeled_key</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – The key for unlabeled batch. Default is None.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – The key for grouping. Default is None.</p></li>
<li><p><strong>key_added</strong> (<em>str</em>) – The key for the added data. Default is ‘X_rep’.</p></li>
<li><p><strong>kl_cutoff</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The cutoff for KL loss. Default is None.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – The beta value for KL loss. Default is 1e-2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.refine">
<span class="sig-name descname"><span class="pre">refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.BaseDataset" title="step.utils.dataset.BaseDataset"><span class="pre">step.utils.dataset.BaseDataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.MaskedDataset" title="step.utils.dataset.MaskedDataset"><span class="pre">step.utils.dataset.MaskedDataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlabeled_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_anchord'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.refine" title="Link to this definition">¶</a></dt>
<dd><p>Refine the model when class labels are available.
Using the class labels, i.e. the cell type information, the model is refined to improve the classification performance and the quality of the embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – The annotated data matrix.</p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.BaseDataset" title="step.utils.dataset.BaseDataset"><em>BaseDataset</em></a>) – The dataset object.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – The number of training epochs. Default is 1.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The batch size. Default is None.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – The learning rate. Default is 1e-3.</p></li>
<li><p><strong>split_rate</strong> (<em>float</em>) – The split rate for train-test split. Default is 0.2.</p></li>
<li><p><strong>tune_lr</strong> (<em>float</em>) – The learning rate for finetuning. Default is 1e-4.</p></li>
<li><p><strong>unlabeled_key</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – The key for unlabeled batch. Default is None.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – The key for grouping. Default is None.</p></li>
<li><p><strong>key_added</strong> (<em>str</em>) – The key for the added data. Default is ‘X_anchord’.</p></li>
<li><p><strong>kl_cutoff</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The cutoff for KL loss. Default is None.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – The beta value for KL loss. Default is 1e-2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf">
<span class="sig-name descname"><span class="pre">clsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">hard</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">soft</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'soft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pred_celltype'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf" title="Link to this definition">¶</a></dt>
<dd><p>Perform cell type classification on the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Annotated data object.</p></li>
<li><p><strong>use_rep</strong> (<em>str</em>) – Key of the representation in <cite>adata.obsm</cite> to be used for classification.</p></li>
<li><p><strong>out</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of output. Either ‘hard’ for hard classification or ‘soft’ for soft classification. Default is ‘soft’.</p></li>
<li><p><strong>key_added</strong> (<em>str</em><em>, </em><em>optional</em>) – Key to add to <cite>adata.obs</cite> for storing the predicted cell types. Default is ‘pred_celltype’.</p></li>
<li><p><strong>as_numpy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the predicted cell types as a numpy array. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted cell types. If <cite>as_numpy</cite> is True, returns a numpy array. Otherwise, returns a torch.Tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pred (numpy.ndarray or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf_">
<span class="sig-name descname"><span class="pre">clsf_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf_" title="Link to this definition">¶</a></dt>
<dd><p>Perform classification using the given representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rep</strong> – The input representation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The softmax output of the classification head.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.impute">
<span class="sig-name descname"><span class="pre">impute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">anndata.AnnData</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.ScDataset" title="step.utils.dataset.ScDataset"><span class="pre">step.utils.dataset.ScDataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">decode_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'expected_counts'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.impute" title="Link to this definition">¶</a></dt>
<dd><p>Imputes missing values in the given dataset using the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Annotated data object containing the dataset.</p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="../../utils/dataset/index.html#step.utils.dataset.BaseDataset" title="step.utils.dataset.BaseDataset"><em>BaseDataset</em></a>) – Dataset object containing the gene expression data.</p></li>
<li><p><strong>decode_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing the decoding information. If not provided, it will be generated using the trained model.</p></li>
<li><p><strong>key_added</strong> (<em>str</em><em>, </em><em>optional</em>) – Key to store the imputed values in the <cite>adata.layers</cite> attribute. Default is ‘expected_counts’.</p></li>
<li><p><strong>rep_key</strong> (<em>str</em><em>, </em><em>optional</em>) – Key to retrieve the representation matrix from <cite>adata.obsm</cite> attribute. If not provided, it will be inferred from the <cite>adata.obsm</cite> keys.</p></li>
<li><p><strong>layer_key</strong> (<em>str</em><em>, </em><em>optional</em>) – Key to retrieve the layer-specific gene expression data from <cite>adata.layers</cite> attribute.</p></li>
<li><p><strong>rep</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Representation matrix. If not provided, it will be generated using the <cite>_embed</cite> method.</p></li>
<li><p><strong>qc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to perform quality control on the imputed values. Default is False.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the <cite>super().impute</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the <cite>super().impute</cite> method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>res</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="step.functionality.sc_funcmodel.scMultiBatchNrmls.reset_model">
<span class="sig-name descname"><span class="pre">reset_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.reset_model" title="Link to this definition">¶</a></dt>
<dd><p>Reset the model parameters.</p>
</dd></dl>

</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../st_funcmodel/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.st_funcmodel</span></code></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../cross_funcmodel/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.cross_funcmodel</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Lounan Li
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">step.functionality.sc_funcmodel</span></code></a><ul>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scSingleBatch"><code class="docutils literal notranslate"><span class="pre">scSingleBatch</span></code></a><ul>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scSingleBatch.model"><code class="docutils literal notranslate"><span class="pre">scSingleBatch.model</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scSingleBatch.handle_input_tuple"><code class="docutils literal notranslate"><span class="pre">scSingleBatch.handle_input_tuple()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls</span></code></a><ul>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.model"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.model</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls._factor"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls._factor</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.loss"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.loss()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.train"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.train()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.handle_input_tuple"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.handle_input_tuple()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.embed"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.embed()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.get_anchors"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.get_anchors()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.run"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.run()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.refine"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.refine()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.clsf()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.clsf_"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.clsf_()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.impute"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.impute()</span></code></a></li>
<li><a class="reference internal" href="#step.functionality.sc_funcmodel.scMultiBatchNrmls.reset_model"><code class="docutils literal notranslate"><span class="pre">scMultiBatchNrmls.reset_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=0b406e39"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>